(e=>{"use strict";function t(e=[]){p(this,e)}if(e.$)return;const r=document;let n=Object.prototype.toString;const s=e=>n.call(e).toLowerCase().replace(/(\[object )|(])/g,""),a=e=>s(e).search("function")>-1,i=e=>"string"===s(e),l=e=>void 0===e,o=e=>!l(e)&&"number"===s(e.length)&&e.length>=0&&!a(e)&&!i(e),d=e=>e instanceof Element,{defineProperty:h,assign:c}=Object,u=e=>Array.from(e),p=(e,t)=>e.splice(e.length,0,...t),f=(e,t)=>{let r=e.indexOf(t);r>-1&&e.splice(r,1)},v=(e,t)=>e.some((e,r)=>!1===t(e,r)),m=getComputedStyle,g=(e,t)=>{let r=e.split(" ");v(r,e=>t(e))},y="XQUE_"+Math.random().toString(32).substr(2),x=y+"_event",b=(e,t,r,n,s)=>{let i=a(t);if(l(t)){if(s)return n(e[0])}else v(e,(e,s)=>{let a;a=i?t.call(e,s,n&&n(e)):t,l(a)||r(e,a,s)});return e},w=(e,t,r,n)=>{let[i,o]=t;if("object"==s(i))for(let t in i)v(e,e=>{r(e,t,i[t])});else if(a(o))v(e,(e,t)=>{o.call(e,t,n(e,i))});else{if(l(o))return n(e[0],i);v(e,e=>{r(e,...t)})}return e},k=e=>"number"==s(e)?e+"px":e,_=(e,t=r)=>u(t.querySelectorAll(e)),E=e=>{let t=r.createElement("div");t.innerHTML=e;return u(t.childNodes).filter(function(e){if(!(e instanceof Text)||e.textContent&&e.textContent.trim())return e})},O=(e,t)=>{if(e===t)return!0;let n=r.createElement("div");return e!==r&&(n.appendChild(e.cloneNode(!1)),0 in _(t,n))},N=e=>e[y]||(e[y]={}),j=e=>e[x]||(e[x]={});let A=Object.create(Array.prototype);c(A,{attr(...e){return w(this,e,(e,t,r)=>{e.setAttribute(t,r)},(e,t)=>e.getAttribute(t))},removeAttr(e){return b(this,e,(e,t)=>{g(t,t=>{e.removeAttribute(t)})})},prop(...e){return w(this,e,(e,t,r)=>{e[t]=r},(e,t)=>e[t])},removeProp(e){return b(this,e,(e,t)=>{g(t,t=>{delete e[t]})})},data(...e){return w(this,e,(e,t,r)=>{N(e)[t]=r},(e,t)=>{let r={};return c(r,e.dataset),c(r,N(e)),r[t]})},removeData(e){return b(this,e,(e,t)=>{g(t,t=>{delete N(e)[t]})})},css(...e){return w(this,e,(e,t,r)=>{String(m(e)[t]).indexOf("px")>-1&&(r=k(r)),e.style[t]=r},(e,t)=>m(e)[t])},text(e){return b(this,e,(e,t)=>{e.textContent=t},e=>e.textContent,1)},html(e){return b(this,e,(e,t)=>{e.innerHTML=t},e=>e.innerHTML,1)},val(e){return b(this,e,(e,t)=>{e.value=t},e=>e.value,1)},each(e){return v(this,(t,r)=>{e.call(t,r,t)}),this},index(e){let t,r;return e?e.nodeType?(r=e,t=this):e instanceof C?(r=e[0],t=this):"string"===s(e)&&(r=this[0],t=C(e)):(r=this[0],t=u(r.parentNode.children)),t.indexOf(r)},extend(e){c(A,e)}});let P={addClass(e,t){e.classList.add(t)},removeClass(e,t){e.classList.remove(t)},toggleClass(e,t){e.classList.toggle(t)}};for(let e in P){let t=P[e];A[e]=function(e){return b(this,e,(e,r)=>{g(r,r=>{t(e,r)})},e=>e.classList.value)}}const T=(e,t)=>{o(e)?v(u(e),e=>{t(e)}):t(e)};let C=function(e,n){let i=[];switch(s(e)){case"string":e.search("<")>-1?i=E(e):T(n,t=>{let r=_(e,t);p(i,r)});break;case"array":i=e;break;default:e instanceof Element?i=[e]:o(e)?i=u(e):a(e)?("complete"===r.readyState?e(C):r.addEventListener("DOMContentLoaded",function(){e(C)},!1),i=[r]):e&&(n&&d(e)?T(n,t=>{let r=e.tagName.toLowerCase(),n=_(r,t);v(n,t=>{e===t&&i.push(t)})}):i=[e])}return new t(i)};const L=(e,t,r)=>{let n=e.length;return b(e,t,(e,t)=>{let a=s(t);n--;let i=t;"string"===a?i=E(t):d(t)&&(i=[t]),n>0&&(i=[].map.call(i,e=>e.cloneNode(!0))),v(i,t=>{r(e,t)})},e=>e.innerHTML)},S=(e,t)=>{e[y]=c({},N(t));let r=j(t),n=j(e);for(let t in r){let s=r[t],a=n[t]=[];v(s,r=>{let n=c({},r);a.push(n),e.addEventListener(t,n.handle)})}},$=(e,t)=>{let r=Array.from(e.children),n=t.children;v(r,(e,t)=>{let r=n[t];S(e,r),$(e,r)})};Object.assign(A,{append(e){return L(this,e,(e,t)=>{e.appendChild(t)})},prepend(e){return L(this,e,(e,t)=>{e.insertBefore(t,e.firstChild)})},before(e){return L(this,e,(e,t)=>{e.parentNode.insertBefore(t,e)})},after(e){return L(this,e,(e,t)=>{var r=e.parentNode;r.lastChild===e?r.appendChild(t):r.insertBefore(t,e.nextSibling)})},wrap(e){return L(this,e,(e,t)=>{e.parentNode.insertBefore(t,e),t.appendChild(e)})},unwrap(){var e=[];return v(this,function(t){var r=t.parentNode;r.parentNode.insertBefore(t,r),-1===e.indexOf(r)&&e.push(r)}),C(e).remove(),this},wrapInner(e){return L(this,e,(e,t)=>{v(u(e.childNodes),function(e){t.appendChild(e)}),e.appendChild(t)})},wrapAll(e){i(e)&&(e=E(e));return this.eq(0).before(e=C(e)),v(this,t=>e.append(t)),this},replaceWith(e){return this.before(e).remove()},empty(){v(this,e=>{e.innerHTML=""})},remove(e){v(this,t=>{e&&!O(t,e)||t.parentNode.removeChild(t)})},clone(e,t){return this.map((r,n)=>{let s=n.cloneNode(!0);return e&&S(s,n),t&&$(s,n),s})}});let D={append:"appendTo",prepend:"prependTo",after:"insertAfter",before:"insertBefore",replaceWith:"replaceAll"};for(let e in D){A[D[e]]=function(t){C(t)[e](this)}}const V=(e,t)=>parseFloat(m(e)[t]);v([{Width:["left","right"]},{Height:["top","bottom"]}],e=>{for(let t in e){let r=t.toLowerCase();A[r]=function(e){return b(this,e,(e,t)=>{t=k(t),e.style[r]=t},e=>V(e,r),1)};let n=e[t],s=(e,t,s,a)=>{let i=V(e,r);return v(n,r=>{t&&(i+=V(e,"padding-"+r)),s&&(i+=V(e,"border-"+r+"-width")),a&&(i+=V(e,"margin-"+r))}),i};A["inner"+t]=function(){return s(this[0],1)};A["outer"+t]=function(e){return s(this[0],1,1,e)}}}),Object.assign(A,{offset(){let e=this[0],t=0,r=0;do{t+=e.offsetTop,r+=e.offsetLeft,e=e.offsetParent}while(e);return{top:t,left:r}},position(){let e=this[0];return{top:e.offsetTop,left:e.offsetLeft}},scrollTop(e){return b(this,e,(e,t)=>{e.scrollTop=t},e=>e.scrollTop,1)},scrollLeft(e){return b(this,e,(e,t)=>{e.scrollLeft=t},e=>e.scrollLeft,1)}});const M=(e,t,r,n)=>{let s=[];return i(t)?v(e,e=>{O(e,t)?r&&r(s,e):n&&n(s,e)}):o(t)?v(e,e=>{v(t,t=>{e===t?r&&r(s,e):n&&n(s,e)})}):d(t)?v(e,e=>{t===e?r&&r(s,e):n&&n(s,e)}):a(t)&&v(e,(e,a)=>{t.call(e,a,e)?r&&r(s,e):n&&n(s,e)}),C(s)},I=(e,t,r)=>{let n=[];return v(r,r=>{!(r=r[t])||-1!=n.indexOf(r)||e&&!O(r,e)||n.push(r)}),C(n)},R=(e,t,r,n)=>{let a=[],i=e=>{let l=e[t];if(l){if(n&&("string"===s(n)&&O(l,n)||n===l||n instanceof Array&&n.indexOf(l)>-1))return;r&&!O(l,r)||-1!==a.indexOf(l)||a.push(l),i(l)}};return v(e,e=>{i(e)}),i=null,C(a)};c(A,{slice(...e){let t=[].slice.call(this,...e);return C(t)},eq(e){return this.slice(e,parseInt(e)+1||void 0)},first(){return this.eq(0)},last(){return this.eq(-1)},get(e){return l(e)?u(this):this[e]},hasClass(e){let t=!1;return v(this,r=>{r.classList.contains(e)&&(t=!0)}),t},filter(e){return M(this,e,(e,t)=>e.push(t))},not(e){return M(this,e,0,(e,t)=>e.push(t))},is(e){return 0 in this.filter(e)},map(e){let t=[];return v(this,(r,n)=>{t.push(e(n,r))}),C(t)},find(e){return C(e,this)},has(e){let t=[];return v(this,r=>{0 in C(e,r)&&t.push(r)}),C(t)},children(e){let t=[];return v(this,r=>{r.nodeType&&v(u(r.children),r=>{e?O(r,e)&&t.push(r):t.push(r)})}),C(t)},next(e){return I(e,"nextElementSibling",this)},prev(e){return I(e,"previousElementSibling",this)},parent(e){return I(e,"parentNode",this)},nextAll(e){return R(this,"nextElementSibling",e)},prevAll(e){return R(this,"previousElementSibling",e)},parents(e){return R(this,"parentNode",e,r)},nextUntil(e,t){return R(this,"nextElementSibling",t,e)},prevUntil(e,t){return R(this,"previousElementSibling",t,e)},parentsUntil(e,t){return R(this,"parentNode",t,e)},closest(e){var t=C(e).parent();return this.parentsUntil(t,e)},siblings(e){let t=this;return this.parent().children(e).filter(function(){if(-1===t.indexOf(this))return!0})},offsetParent(){let e=[];return v(this,t=>{e.push(t.offsetParent||r.body)}),C(e)}});let U={preventDefault(){this._pD()},isDefaultPrevented(){return this.defaultPrevented},stopPropagation(){this._sP()},isPropagationStopped(){return this.cancelBubble},stopImmediatePropagation(){this.isImmediatePropagationStopped=(()=>!0),this._sIP()},isImmediatePropagationStopped:()=>!1};const H=e=>(e._pD||(Object.defineProperties(e,{_pD:{value:e.preventDefault},_sP:{value:e.stopPropagation},_sIP:{value:e.stopImmediatePropagation}}),Object.assign(e,U)),e);let q=MouseEvent,B=e.TouchEvent||Event,F={click:q,mousedown:q,mouseup:q,mousemove:q,mouseenter:q,mouseleave:q,touchstart:B,touchend:B,touchmove:B},J=["focus","blur"],W=C.Event=((e,t)=>{let r=F[e]||Event;return H(new r(e,t))});const X=(e,t)=>{let r=j(e);return r[t]||(r[t]=[])},G=(e,t,r,n)=>(v(e,e=>{if(d(e)){if(!n&&!r&&J.indexOf(t)>-1&&a(e[t]))return void e[t]();let s;s=t instanceof Event?t:n?new Event(t,{bubbles:!1,cancelable:!0}):W(t,{bubbles:!0,cancelable:!0}),r&&h(s,"_argData",{value:r}),e.dispatchEvent(s)}else{let n=X(e,t),s=[],a=0;v(n,e=>{if(e.isOne||s.push(e),a)return;let n=W(t),i=[n];r&&i.push(r);let o=e.data;l(o)||(n.data=o),e.fn(...i),delete n.data,n.isImmediatePropagationStopped()&&(a=1)});j(e)[t]=s}}),e),K=(e,t,r,n,s,h)=>{if(t=t.split(" "),a(r)?(s=r,r=n=void 0):i(r)?a(n)&&(s=n,n=void 0):(s=n,n=r,r=void 0),s)return v(e,e=>{v(t,t=>{let a={fn:s,isOne:h,data:n,selector:r};if(d(e)){let i=function(a){H(a),!l(n)&&(a.data=n),a.originalEvent=a;let d=a._argData;d&&!o(d)&&(d=[d]);let c=this,u=1;if(r){let e=C(a.target).parents(r);0 in e?c=e[0]:O(a.target,r)?c=a.target:u=0}u&&(d?s.call(c,a,...d):s.call(c,a)),delete a.data,delete a.originalEvent,h&&e.removeEventListener(t,i)};a.handle=i,e.addEventListener(t,i)}X(e,t).push(a)})}),e;console.error("no function =>",s)};Object.assign(A,{on(e,t,r,n){return K(this,e,t,r,n)},one(e,t,r){return K(this,e,void 0,t,r,1)},off(e,t,r){return((e,t,r,n)=>(t&&(t=t.split(" "),!n&&a(r)&&(n=r,r=void 0)),v(e,e=>{let s=j(e);if(t)v(t,t=>{let a=X(e,t);if(d(e))if(n){let s=a.find(function(e){return e.fn===n&&e.selector===r});s&&(e.removeEventListener(t,s.handle),f(a,s))}else v(a,r=>{e.removeEventListener(t,r.handle)}),s[t]=[];else n?f(a,n):s[t]=[]});else{if(d(e))for(let t in s){let r=s[t];v(r,r=>{e.removeEventListener(t,r.handle)})}e[x]={}}}),e))(this,e,t,r)},trigger(e,t){return G(this,e,t)},triggerHandler(e,t){return G(this,e,t,1)},bind(e,t,r){return this.on(e,t,r)},unbind(e,t){return this.off(e,t)},hover(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),v("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e){A[e]=function(t){return t?this.on(e,t):this.trigger(e),this}});let z={url:"",type:"GET",data:"",crossDomain:!1,dataType:"",headers:{},timeout:1e5,username:null,password:null,contentType:"json"};const Q=e=>{let t=c({},z);c(t,e),t.type=t.type.toUpperCase();let{url:r,contentType:n,data:s}=t;if(s instanceof FormData)n="form";else if(n.indexOf("form")>-1){let e=new FormData;for(let t in s)e.append(t,s[t]);s=e}switch(t.type){case"GET":n="";let e=Y(s);r+=(r.indexOf("?")>-1?r+="&":"?")+e,s=null;break;case"POST":n.indexOf("json")>-1?(n="application/json; charset=UTF-8",s=JSON.stringify(s)):n.indexOf("urlencoded")>-1?(n="application/x-www-form-urlencoded; charset=UTF-8",s=Y(s)):n.indexOf("form")>-1?n="multipart/form-data; charset=UTF-8":n.indexOf("xml")>-1&&(n="text/xml; charset=UTF-8")}let a=C({});var i=new XMLHttpRequest;let l=new Promise((e,s)=>{i.open(t.type,r,!0,t.username,t.password);let{headers:l}=t;for(let e in l)i.setRequestHeader(e,l[e]);n&&i.setRequestHeader("Content-Type",n),i.responseType=t.dataType,i.withCredentials=t.crossDomain,i.timeout=t.timeout,i.addEventListener("load",t=>{let{target:r}=t,{response:n}=t.target,s=r.getResponseHeader("content-type");s&&s.indexOf("application/json")>-1&&"object"!=typeof n&&(n=JSON.parse(n)),e(n)},!1),i.addEventListener("error",e=>{s()},!1),i.addEventListener("progress",e=>{a.trigger("loading",e)},!1),i.upload&&i.upload.addEventListener("progress",e=>{a.trigger("uploading",e)},!1)});return c(l,{loading:e=>(a.on("loading",(t,r)=>e(r)),l),uploading:e=>(a.on("uploading",(t,r)=>e(r)),l),beforeSend:e=>(e(i),l)}),setTimeout(()=>{s?i.send(s):i.send()},0),l.options=t,l},Y=(e,t="",r)=>{let n="";for(let s in e){let a=e[s];"object"==typeof a?n+=t?Y(a,`${t}[${s}]`,r):Y(a,s,r):(t&&(e instanceof Array&&(s=""),s=t+`[${s}]`),r||(s=encodeURIComponent(s),a=encodeURIComponent(a)),n+=`${s}=${a}&`)}return t||(n=n.replace(/&$/g,"")),n};c(C,{ajax:Q,ajaxSetup:e=>{c(z,e)},param:e=>Y(e,"",1)}),v(["get","post"],e=>{C[e]=((t,r,n)=>{let s={url:t,type:e.toUpperCase(),data:r};return n&&(s.dataType=n),Q(s)})}),c(A,{show(){return v(this,e=>{e.style.display=""}),this},hide(){return v(this,e=>{e.style.display="none"}),this}}),C.prototype=C.fn=t.prototype=A,c(C,{extend(...e){if(1!==e.length)return c(...e);{let t=e[0];"object"==s(t)&&c(C,t)}},merge:p,type:s}),e.Xque=e.$=C})(window),(e=>{"use strict";function t(e,t,r){o(this,{_id:{value:f()},[j]:{value:{}},[A]:{value:[]},[T]:{value:[]},[P]:{get:()=>this},[C]:{value:[]},_trendClear:{writable:!0,value:0}}),e.hasOwnProperty("_id")||l(e,"_id",{value:this._id}),t&&o(this,{_host:{writable:!0,value:t},_hostkey:{writable:!0,value:r}});let n=Object.keys(e);"array"===u(e)&&!n.includes("length")&&n.push("length");let s=new Proxy(this,F);return n.forEach(t=>{let{get:r,set:n,value:a}=Object.getOwnPropertyDescriptor(e,t);r||n?l(this,t,{get:r,set:n}):this[t]=X(a,s,t)}),s}let r=e.$,n=r.fn,s={};e.tagDatabase=s;const{assign:a,create:i,defineProperty:l,defineProperties:o}=Object;let d=e=>void 0!==e&&null!==e;const h=(e,t)=>{if(!e.getAttribute)return!1;let r=e.getAttribute(t);return null!==r&&void 0!==r||void 0};let c=Object.prototype.toString;const u=e=>c.call(e).toLowerCase().replace(/(\[object )|(])/g,""),p=(e,t)=>Array.from(e).forEach(t),f=()=>Math.random().toString(32).substr(2),v=((()=>{let e=!1,t=[]})(),f(),f()+"_xhearobj"),m=f()+"_attached",g=e=>{let t=e.tagName.toLowerCase();return s[t]},y=e=>{let t=e[v],r=i(t);return t._pausedEmit=1,r.push(e),delete t._pausedEmit,r},x=e=>1==e.length&&e[0][v]?y(e[0]):(e=>{let t=i(w);return t.splice(-1,0,...e),e.prevObject&&(t.prevObject=e.prevObject),t})(e),b=e=>{e.is("[xv-ele]")&&e.each((e,t)=>{O(t)}),r("[xv-ele]",Array.from(e)).each((e,t)=>{O(t)})};let w=i(n),k=100;const _=(e,t)=>{let{tag:r}=e;t&&t[r]&&(r=t[r]);let n={};Object.keys(e).forEach(t=>{/\D/.test(t)&&(n[t]=e[t])}),delete n.tag,delete n.length;let s=N(`<${r} xv-ele xv-render-ele xv-rid="${e._id}"></${r}>`);return a(s,n),Array.from(e).forEach(e=>{s.append(_(e,t))}),s},E=(e,t,r)=>{e.hide(),e.empty(),t.forEach(t=>{e.append(_(t,r))}),e.show()},O=e=>{if(!h(e,"xv-ele"))return;let t=g(e);if(!t)return void console.warn("no exist tag",e);let n=r(e),s=Array.from(e.childNodes);e.innerHTML=t.temp;let i=++k,o=new t.XHear({}),c=new Proxy(o,F);e[v]=c;let p=y(e);n.removeAttr("xv-ele").attr("xv-render",i),n.find("*").attr("xv-shadow",i),r(`[xv-ele][xv-shadow="${i}"]`,e).each((e,t)=>{O(t)}),r(`xv-span[xv-shadow="${i}"]`,e).each((e,t)=>{var r=document.createTextNode("");t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t);var n=t.getAttribute("svkey");c.watch(n,e=>{r.textContent=e})});let f=r(`[xv-content][xv-shadow="${i}"]`,e);if(0 in f&&(l(c,"$content",{enumerable:!0,get:()=>x(f)}),f.prop("svParent",e),f.append(s),t.childChange)){let r=new MutationObserver(r=>{r.forEach(r=>{let{addedNodes:n,removedNodes:s}=r,a={};0 in n&&(a.addedNodes=Array.from(n)),0 in s&&(a.removedNodes=Array.from(s)),t.childChange(y(e),a)})});r.observe(f[0],{attributes:!1,childList:!0,characterData:!1,subtree:!1}),c.__obs=r}r(`[xv-tar][xv-shadow="${i}"]`,e).each((e,t)=>{let n=r(t).attr("xv-tar");l(c,"$"+n,{enumerable:!0,get:()=>x([t])})});let b=a({},t.data);t.attrs.forEach(e=>{let t=n.attr(e);d(t)&&(b[e]=t),c.watch(e,t=>{n.attr(e,t)})}),t.props.forEach(e=>{let t=n.attr(e);d(t)&&(b[e]=t)}),r(`[xv-module][xv-shadow="${i}"]`,e).each((e,t)=>{let n=r(t),s=n.attr("xv-module");c.watch(s,e=>{t.value=e}),t[v]?t[v].watch("value",e=>{c[s]=e}):n.on("change input",e=>{c[s]=t.value})}),n.removeAttr("xv-ele").attr("xv-render",i);let w=t.watch;if(w)for(let e in w)e in b||(b[e]=void 0);p.watch("render",(e,r)=>{let{trend:n}=r;if("new"===r.type||n&&!n.methodName&&1===n.keys.length)return void E(p,e,t.renderMap);let s,{target:a,key:i,value:l}=I(p,n);if(s=1==n.keys.length&&"render"==n.keys[0]?p:p.find(`[xv-rid="${a._id}"]`),"array-method"==n.type){switch(n.methodName){case"fill":case"reverse":case"sort":return void E(s,a,t.renderMap)}let e,r,i;switch(n.methodName){case"splice":[e,r,...i]=n.args;break;case"shift":e=0,r=1,i=[];break;case"unshfit":e=0,r=0,i=n.args;break;case"push":e=s.children("[xv-render-ele]").length,r=0,i=n.args;break;case"pop":e=s.children("[xv-render-ele]").length,r=1,i=[]}let l=parseInt(e)+parseInt(r);r>0&&s.children("[xv-render-ele]").each((t,r)=>{t>=e&&t<l&&N(r).remove()});let o=s.children("[xv-render-ele]").eq(e);i.forEach(e=>{let r=_(e,t.renderMap);0 in o?o.before(r):s.append(r)})}else if(/\D/.test(i)){p.find(`[xv-rid="${a._id}"]`)[i]=l}else{let{oldVal:e}=n,r=e._id;if(r){let e=p.find(`[xv-rid="${r}"]`);e.after(_(l,t.renderMap)),e.remove()}else{let e=_(l,t.renderMap);if(a._host._id===p._id)p.append(e);else{p.find(`[xv-rid="${a._id}"]`).append(_(l,t.renderMap))}}}});let j=Object.keys(b);if(j.includes("value")||j.push("value"),j.includes("render")||j.push("render"),o._exkeys=j,w)for(let e in w){let t,r,n=w[e];switch(u(n)){case"function":r=n;break;case"object":t=n.get,r=n.set}t&&watchGetter(c,e,t.bind(p)),r&&c.watch(e,r.bind(p))}l(e,"value",{get:()=>c.value,set(e){c.value=e}});for(let e in b)d(b[e])&&(c[e]=b[e]);t.inited&&t.inited.call(e,p),t.attached&&e.getRootNode()===document&&!e[m]&&(t.attached.call(e,p),e[m]=1)};let N=function(...e){let t=r(...e),[n,s]=e;("string"==u(n)&&n.search("<")>-1||n instanceof Element)&&b(t);let a;return s&&(s.getAttribute?a=s.getAttribute("xv-shadow"):s.attr&&(a=s.attr("xv-shadow"))),t=a?z(t,a):z(t),t=x(t)};N.prototype=n,a(N,{init:(...e)=>x(e)},r);const j="_events_"+f(),A="_trend_"+f(),P="_getxdata_"+f(),T="_syncs_"+f(),C="_listen_"+f();let L;(()=>{let e=[],t=0;L=(r=>{e.push(r),t||setTimeout(()=>{t=0;let r=e;e=[],r.forEach(e=>e())},5e3),t=1})})();let S=e=>e instanceof Object?JSON.parse(JSON.stringify(e)):e;const $=e=>e instanceof t,D=e=>{e[C].forEach(t=>{e.unlisten(t.callback)}),e[T].forEach(t=>{e.unsync(t.opp,t.options)});let t=e[j];for(let e in t)delete t[e]},V=(e,t)=>e[j][t]||(e[j][t]=[]),M=(e,t,r)=>{V(e,t).forEach(t=>{t.apply(e,r)})};let I=(e,t)=>{let r,n=t.keys.length-1;t.keys.forEach((t,s)=>{s<n&&(e=e[t]),r=t});let s={type:t.type,add:t.add,remove:t.remove},i=e[r];switch(t.type){case"new":case"update":case"delete":a(s,{target:e,key:r,value:n>=0?i:void 0}),void 0!==t.oldVal&&(s.oldVal=t.oldVal);break;case"sort":a(s,{target:n>=0?i:e,sort:t.sort});break;case"array-method":a(s,{target:n>=0?i:e,args:t.args,methodName:t.methodName,returnValue:t.returnValue})}return s};const R=(e,t)=>{e._pausedEmit=1,t(),delete e._pausedEmit},U=(e,t,r)=>{let n=[];void 0===r?e.hasOwnProperty(t)&&n.push(e):e[t]==r&&n.push(e);for(let s in e){let a=e[s];if($(a)){U(a,t,r).forEach(e=>{n.includes(e)||n.push(e)})}}return n},H=e=>{let{target:t,key:r,value:n,oldVal:s,type:i,trendData:o}=e;if(t._pausedEmit)return;let d=(e=>{let t=S(e);return e.args&&(t.args=e.args.slice()),e.returnValue&&l(t,"returnValue",{value:e.returnValue}),void 0!==e.oldVal&&l(t,"oldVal",{value:e.oldVal}),e.add&&l(t,"add",{value:e.add}),e.remove&&l(t,"remove",{value:e.remove}),t})(o);if(void 0!==r)d.keys.unshift(r),M(t,"watch-"+r,[n,{oldVal:s,type:i,trend:d}]),M(t,"watch-",[{key:r,val:n,type:i,oldVal:s,trend:d}]);else{let e={type:i,trend:d};switch(o.type){case"sort":a(e,{sort:d.sort});break;case"array-method":a(e,{args:d.args,methodName:d.methodName,returnValue:d.returnValue})}M(t,"watch-",[e])}let{_host:h,_hostkey:c}=t;h&&H({target:h,key:c,value:t,oldVal:t,type:"update",trendData:d})};let q=Array.prototype;const B=e=>{let{xdata:t,key:r,value:n,receiver:s,type:i,tid:d,sort:h,args:c,methodName:u}=e;if(d=d||f(),t[A].includes(d))return;((e,t)=>{e[A].push(t),e._trendClear||(e._trendClear=1,L(()=>{e[A].length=0,e._trendClear=0}))})(t,d);let p={tid:d,type:i=i||(t.hasOwnProperty(r)?"update":"new"),keys:[]};o(p,{add:{value:[]},remove:{value:[]}});let v={target:s,key:r,type:i,trendData:p},m=!0;switch(i){case"new":case"update":if((g=t[r])==n)return;if($(g)&&g.string===JSON.stringify(n))return;let o=X(n,s,r);t._exkeys&&t._exkeys.includes(r)?t[r]=o:Reflect.set(t,r,o,s),p.val=n,l(p,"oldVal",{value:g}),$(g)&&p.remove.push(g),$(o)&&p.add.push(o),a(v,{value:t[r],oldVal:g});break;case"delete":var g=t[r];$(g)&&p.remove.push(g),delete t[r],a(v,{oldVal:g});break;case"sort":!e.isRunned&&R(t,()=>{let e=t.slice();h.forEach((t,r)=>{s[t]=e[r]})}),p.sort=h;break;case"array-method":R(t,()=>{let e;switch("fill"===u&&(e=s.slice()),m=q[u].apply(s,c),l(p,"returnValue",{value:m}),u){case"splice":m.forEach(e=>{$(e)&&p.remove.push(e)});let[,,...t]=c;t.forEach(e=>{let t=s.seek(e._id);t&&p.add.push(t)});break;case"pop":case"shift":$(m)&&p.remove.push(m);break;case"unshift":case"push":c.forEach(e=>{let t=s.seek(e._id);t&&p.add.push(t)});break;case"fill":e.forEach(e=>{$(e)&&p.remove.push(e)}),s.forEach(e=>{$(e)&&p.add.push(e)})}}),a(p,{args:c,methodName:u})}return H(v),m},F={set:(e,t,r,n)=>/^_.+/.test(t)?Reflect.set(e,t,r,n):(B({xdata:e,key:t,value:r,receiver:n}),!0),deleteProperty:(e,t)=>/^_.+/.test(t)?Reflect.deleteProperty(e,t):(B({xdata:e,key:t,receiver:e,type:"delete"}),!0)};let J=Object.create(q);o(J,{string:{get(){return JSON.stringify(this)}},object:{get(){return S(this)}},root:{get(){let e,t=this._host;for(;t;)e=t,t=t._host;return e}},keylist:{get(){let e=this,t=[];for(;e._host;)t.unshift(e._hostkey),e=e._host;return t}}});let W={entrend(e){let{target:t,key:r,value:n,sort:s,args:i,methodName:l}=I(this,e),o={xdata:t[P],receiver:t,type:e.type,tid:e.tid};switch(e.type){case"new":case"update":case"delete":a(o,{key:r,value:e.val});break;case"sort":a(o,{sort:s});break;case"array-method":a(o,{methodName:l,args:i})}B(o)},detrend(e){return I(this,e)},watch(e,t){let r=u(e);if("object"===r){for(let t in e)this.watch(t,e[t]);return this}return r.search("function")>-1&&(t=e,e=""),((e,t,r)=>V(e,t).push(r))(this,"watch-"+e,t),this},unwatch(e,t){let r=u(e);if("object"===r){for(let t in e)this.unwatch(t,e[t]);return this}return r.search("function")>-1&&(t=e,e=""),((e,t,r)=>{let n=V(e,t),s=n.indexOf(r);n.splice(s,1)})(this,"watch-"+e,t),this},sync(e,t){let r,n;switch(u(t)){case"object":let s={};for(let e in t)s[t[e]]=e;r=(e=>{let t=S(e.trend),r=s[e.key];void 0!==r&&(t.keys[0]=r,this.entrend(t))}),n=(r=>{let n=S(r.trend),s=t[r.key];void 0!==s&&(n.keys[0]=s,e.entrend(n))});break;case"array":r=(e=>{t.includes(e.key)&&this.entrend(S(e.trend))}),n=(r=>{t.includes(r.key)&&e.entrend(S(r.trend))});break;case"string":r=(e=>{e.key===t&&this.entrend(S(e.trend))}),n=(r=>{r.key===t&&e.entrend(S(r.trend))});break;default:r=(e=>this.entrend(S(e.trend))),n=(t=>e.entrend(S(t.trend)))}e.watch(r),this.watch(n);let s=f();return e[T].push({bid:s,options:t,opp:this,func:r}),this[T].push({bid:s,options:t,opp:e,func:n}),this},unsync(e,t){let r=this[T].findIndex(r=>r.opp===e&&r.options===t);if(r>-1){let t=this[T][r],n=e[T].findIndex(e=>e.bid===t.bid),s=e[T][n];this.unwatch(t.func),e.unwatch(s.func),this[T].splice(r,1),e[T].splice(n,1)}else console.log("not found =>",e);return this},seek(e){if(!e)return;let t,r=e.match(/\[.+?\]/g);return r?r.forEach((e,r)=>{let[n,s]=e.replace(/[\[]|[\]]/g,"").split("="),a=U(this,n,s);if(0===r)t=a;else{let e=[];a.forEach(r=>{t.includes(r)&&e.push(r)}),t=e}}):t=U(this,"_id",e)[0],t},listen(e,t,r,n=10){let s,a=u(e);if(a.search("function")>-1)r=e,e=null,t=null;else if("string"===a||"number"==a)if(/\[.+\]/.test(e))r=t,t=e,e=null;else{u(t).search("function")>-1&&(r=t,t=null)}let i,l,o=[],d=[];if(t)if(e){let r=this[e];$(r)&&(l=JSON.stringify(r.seek(t).map(e=>e._id)))}else l=JSON.stringify(this.seek(t).map(e=>e._id));return this.watch(s=(s=>{if(t){let a,o;if(e){let r=this[e];if(e!=s.trend.keys[0]||!$(r))return;o=(a=r.seek(t)).map(e=>e._id)}else o=(a=this.seek(t)).map(e=>e._id);let d=JSON.stringify(o);d!==l&&(clearTimeout(i),i=setTimeout(()=>{r(a)},n),l=d)}else{if(e&&e!=s.trend.keys[0])return;clearTimeout(i),o.push(...s.trend.add),d.push(...s.trend.remove),i=setTimeout(()=>{r({add:o,remove:d}),o=[],d=[]},n)}})),this[C].push({callback:r,watchFunc:s}),this},unlisten(e){let t;return this[C].forEach((r,n)=>{if(r.callback===e){let{watchFunc:e}=r;t=n,this.unwatch(e)}}),this[C].splice(t,1),this},transData(e){let t={key:"",target:"",targetKey:""};a(t,e);let{key:r,target:n,targetKey:s,trans:i}=t;if(t.trans){let e={};for(let t in i)e[i[t]]=t;this.watch(r,e=>{e=i[e],n[s]=e}),n.watch(s,t=>{t=e[t],this[r]=t})}},clear(...e){let[t]=e;if(0 in e)if(/\D/.test(t)){let e=this[t];delete this[t],$(e)&&D(e)}else{let e=this.splice(t,1)[0];$(e)&&(e._host=null,D(e))}else this._host?this._host.clear(this._hostkey):D(this)},reset(e){let t=Object.keys(e);return Object.keys(this).forEach(e=>{t.includes(e)||"length"===e||delete this[e]}),a(this,e),this},clone(){return X(this.object)},sort(...e){let t,r=this.map(e=>e._id),n=this[P];R(n,()=>{t=q.sort.apply(this,e)});let s=this.map(e=>e._id),a=[];return r.forEach((e,t)=>{let r=s.indexOf(e);a[t]=r}),B({xdata:n,receiver:this,type:"sort",sort:a,isRunned:1}),t},copyWithin(){throw"can't use copyWithin"}};Object.keys(W).forEach(e=>{l(J,e,{value:W[e]})}),["splice","shift","unshfit","push","pop","fill","reverse"].forEach(e=>{J[e]&&l(J,e,{value(...t){return B({xdata:this[P],receiver:this,type:"array-method",methodName:e,args:t})}})}),t.prototype=J;const X=(e,r,n)=>{if($(e))return e._host=r,e._hostkey=n,e;switch(u(e)){case"array":case"object":return new t(e,r,n)}return e};N.xdata=(e=>X(e)),N.detrend=I;let G=Object.create(w);G.svRender=!0;for(let e in W)l(G,e,{value:W[e]});l(G,"set",{value(e,t){-1===this._exkeys.indexOf(e)&&this._exkeys.push(e),this[e]=t}});const K=e=>{let n={tag:"",temp:"",attrs:[],props:[],data:{},watch:{}};a(n,e);let{proto:o,props:d,temp:h,tag:c}=n;d.push("value");let u=function(...e){t.apply(this,e)},p=G;if(o){p=i(G);for(let e in o){let{get:t,set:r}=Object.getOwnPropertyDescriptor(o,e);t||r?l(p,e,{set:r,get:t}):p[e]=o[e]}}u.prototype=p;var f=(h=h.replace(/<!--.+?-->/g,"")).match(/{{.+?}}/g);f&&f.forEach(e=>{var t=/{{(.+?)}}/.exec(e);t&&(h=h.replace(e,`<xv-span svkey="${t[1].trim()}"></xv-span>`))}),s[c]=a({},n,{XHear:u,temp:h}),r(n.tag+"[xv-ele]").each((e,t)=>{O(t)})};N.register=K;const z=(e,t)=>{let n=0,s=[],{prevObject:a}=e;return t?e.each((e,r)=>{h(r,"xv-shadow")&&r.getAttribute("xv-shadow")==t&&(s.push(r),n=1)}):e.each((e,t)=>{h(t,"xv-shadow")?n=1:s.push(t)}),n&&(e=r(s),a&&(e.prevObject=a)),e},Q=(e,t)=>{let r=e[0].tagName.toLowerCase(),n=s[r],a=new Set([...Object.keys(n.data),...n.props,...n.attrs]);p(a,r=>{e[r]=t[r]})},Y=e=>{let t=e.attr("xv-render");t&&(e.find(`[xv-shadow="${t}"]:not([xv-content])`).remove(),e.find(`[xv-shadow="${t}"][xv-content]`).each((e,t)=>{0 in t.childNodes&&r(t).before(t.childNodes).remove()}));e.find("[xv-render]").each((e,t)=>{Y(r(t))})},Z=(e,t)=>{let n=u(t);if(e.is("[xv-shadow]")){let s=e.attr("xv-shadow");if("string"==n&&t.search("<")>-1){let e=r(t);e.attr("xv-shadow",s),e.find("*").attr("xv-shadow",s),t="",p(e,e=>{t+=e.outerHTML})}else n instanceof Element?r(t).attr("xv-shadow",s):t instanceof N&&r(Array.from(t)).attr("xv-shadow",s)}return t},ee=e=>(e.is("[xv-render]")&&(e=e.map((e,t)=>{let r=t,n=t[v];for(;n&&n.$content;)n=(r=n.$content[0]).xvData;return r})),e);a(w,{add(...t){let r=t[0];if(r instanceof e.$&&r.is("xv-shadow"))throw"shadow element can't use add";return n.add.apply(this,t)},attr(...e){let[t,s]=e;return s&&this.is("[xv-render]")?(this.each((a,i)=>{let l=g(i);l&&l.attrs.indexOf(t)>-1?i[v][t]=s:n.attr.apply(r(i),e)}),this):n.attr.apply(this,e)},clone(...e){if(this.is("[xv-shadow]"))throw"shadow element can't use clone";if(this.svRender){let e=this.html(),t=r(`<div>${e}</div>`);t.find("[xv-render]").each((e,t)=>{r(t).removeAttr("xv-render").attr("xv-ele","")}),e=t.html();this[0].tagName.toLowerCase();let n=this[0].cloneNode();r(n).removeAttr("xv-render").attr("xv-ele","").html(e),O(n);let s=y(n);Q(s,this);let a=r("[xv-render]:not([xv-shadow])",this);if(0 in a){let e=r("[xv-render]:not([xv-shadow])",s);e.length==a.length&&e.each((e,t)=>{let r=a[e];if(r.tagName!==t.tagName)return console.warn("cloned xv-ele data does not match"),!1;Q(y(t),y(r))})}return s}{let t=this.is("[xv-render]"),s=0 in this.find("[xv-render]");if(t||s){let t=r(Array.from(this)),n=t.clone(...e);Y(n),n.find("[xv-render]").removeAttr("xv-render").attr("xv-ele",""),b(n),t.each((e,t)=>{h(t,"xv-render")&&(n[e]=y(t).clone()[0])});let s=e=>{let r=n.find(e);if(0 in r){let n=t.find(e);r.length==n.length&&n.each((e,t)=>{Q(y(r[e]),y(t))})}};return s("[xv-render]:not([xv-shadow])"),s("[xv-render][xv-shadow]"),this.prevObject&&(n.prevObject=this),x(n)}n.clone.apply(this,e)}},empty(){return n.empty.call(ee(this)),this},parent(e){let t=this.map((e,t)=>{let r=t.parentNode;for(;r.svParent;)r=r.svParent;return r}),r=x(Array.from(new Set(t)));return e&&(r=r.filter(e)),r},parents(e){let t=[];this.each((e,r)=>{let n=r.parentNode;for(;n&&n!==document;){for(;n.svParent;)n=n.svParent;t.push(n),n=n.parentNode}});let r=x(Array.from(new Set(t)));return e&&(r=r.filter(e)),r},parentsUntil(e){let t=[];return this.each((n,s)=>{let a=s.parentNode;for(;a&&a!==document;){for(;a.svParent;)a=a.svParent;if(e&&r(a).is(e))break;t.push(a),a=a.parentNode}}),x(new Set(t))},unwrap(){let e=r(this).parent();return e.is("[xv-content]")?e.each((e,t)=>{let{svParent:n}=t;n=r(n?n:t);let s=t.childNodes;p(s,e=>{n.before(e)}),n.remove()}):n.unwrap.call(this),this},findReal(...e){return x(n.find.apply(this,e))},findShadow(...e){let t=n.find.apply(this,e);return t=z(t,this.attr("xv-render")),x(t)}}),p(["after","before","wrap","wrapAll","replaceWith"],e=>{let t=n[e];t&&(w[e]=function(e){return t.call(this,Z(this,e)),b(this.parent()),this})}),p(["insertAfter","insertBefore","replaceAll"],e=>{let t=n[e];t&&(w[e]=function(n){if(this.is("[xv-shadow]"))throw"shadow element can't use "+e;return t.call(Z(r(n),this),n),this})}),p(["append","prepend","wrapInner"],e=>{let t=n[e];t&&(w[e]=function(e){return t.call(ee(this),Z(this,e)),b(this),this})}),p(["appendTo","prependTo"],e=>{let t=n[e];t&&(w[e]=function(n){if(this.is("[xv-shadow]"))throw"shadow element can't use "+e;let s=r(n);return s.is("[xv-shadow]")&&Z(s,this),t.call(this,ee(s)),this})}),p(["find","children"],e=>{let t=n[e];t&&(w[e]=function(e){let r=t.call(ee(this),e);return 1==r.length&&r[0][v]?r=y(r[0]):(r=this.is("[xv-shadow]")?z(r,this.attr("xv-shadow")):z(r),r=x(r)),r})}),p(["eq","first","last","filter","has","not","slice","next","nextAll","nextUntil","prev","prevAll","prevUntil","siblings"],e=>{n[e]&&(w[e]=function(...t){let r=n[e].apply(this,t);return r=x(r)})}),p(["html","text"],e=>{let t=n[e];t&&(w[e]=function(n){let s=this;if((e=>void 0===e)(n)){let e=r(s[0]);if(0 in e.find("[xv-shadow]")){let n=r(e[0].cloneNode(!0));return Y(n),t.call(n)}return t.call(e)}return"text"!==e&&(n=Z(this,n)),s=t.call(ee(this),n),b(this),s})}),(()=>{let{pushStack:e}=n;e&&(w.pushStack=function(...t){return x(e.apply(this,t))})})();const te={register:K};e.xhear=te,e.$=N,r(()=>{const e=e=>{if(e[m])return;let t=g(e);t.attached&&t.attached.call(e,y(e)),e[m]=1},t=e=>{if(e.getRootNode()!=document){let t=g(e);t.detached&&t.detached.call(e,y(e)),r("[xv-content]",e).each((e,t)=>{delete t.svParent});let n=e[v];n&&(n.__obs&&n.__obs.disconnect(),delete n.__obs,delete e[v])}};new MutationObserver(n=>{n.forEach(n=>{let{addedNodes:s,removedNodes:a}=n;s&&0 in s&&p(s,t=>{t[v]&&e(t),t instanceof Element&&p(t.querySelectorAll("[xv-render]"),t=>{e(t)})}),a&&0 in a&&p(a,e=>{e[v]&&t(e),r("[xv-render]",e).each((e,r)=>{t(r)})})})}).observe(document.body,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),r("[xv-ele]").each((e,t)=>{O(t)})}),r("head").append("<style>[xv-ele]{display:none}</style>")})(window);