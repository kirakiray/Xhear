(e=>{"use strict";let t={};const r=Object.assign,s=Object.create,a=Object.defineProperty;const n=(e,t)=>{if(!e.getAttribute)return 0;let r=e.getAttribute(t);return null!==r&&void 0!==r?1:void 0};let l=Object.prototype.toString;const o=e=>l.call(e).toLowerCase().replace(/(\[object )|(])/g,""),i=(e,t)=>Array.from(e).forEach(t),h=()=>Math.random().toString(32).substr(2),d=((()=>{let e=!1,t=[]})(),"_"+h()),c=d+"_watchs",v=d+"_watchs_ori",f="_svkey"+d;let p=e.$,u=p.fn,m=s(u);const w=u.splice?e=>{let t=s(m);return t.splice(-1,0,...e),e.prevObject&&(t.prevObject=e.prevObject),t}:e=>{let t=s(m);for(let r=e.length,s=0;s<r;s++)t.push(e[s]);return e.prevObject&&(t.prevObject=e.prevObject),t},b=e=>{let t=e._svData,r=s(t);return r.push(e),r},g=e=>{e.each((e,t)=>{n(t,"sv-ele")&&D(t)}),p("[sv-ele]",Array.from(e)).each((e,t)=>{D(t)})},_=(e,t)=>{let r=0,s=[],{prevObject:a}=e;return t?e.each((e,a)=>{n(a,"sv-shadow")&&a.getAttribute("sv-shadow")==t&&(s.push(a),r=1)}):e.each((e,t)=>{n(t,"sv-shadow")?r=1:s.push(t)}),r&&(e=p(s),a&&(e.prevObject=a)),e},y=e=>{let r=e.tagName.toLowerCase();return t[r]},A=(e,t,r=c)=>e[r][t]||(e[r][t]=[]),N=(e,t,r)=>{A(e,t,v).push(r)},O=(e,t,r)=>{let s=e[t],a=A(e,t),n=A(e,t,v);a.concat(n).forEach(e=>{e(r,s)})};let j=r(s(m),{set(e,t){if("object"==o(e)){if(!t)for(let t in e)this.set(t,e[t]);return}let r=this;if(0 in r&&r[0]._svData&&(r=r[0]._svData),e in r)return void console.warn("the value exists => ",e);let s;a(r,e,{enumerable:!0,get:()=>s,set:t=>(O(r,e,t),s=t,t)}),r[e]=t},watch(e,t){if("string"==o(e)){A(this,e).push(t)}else for(let t in e)this.watch(t,e[t])},unwatch(e,t){if(e){let r=A(this,e);if(t){let e=r.indexOf(t);r.splice(e,1)}else r.length=0}},svRender:!0});const D=e=>{if(n(e,"sv-ele")){let t=y(e);if(!t)return void console.warn("this element is not defined",e);let s=p(e),n=Array.from(e.childNodes);e.innerHTML=t.code;let l=new t.Shear;e._svData=l,p("sv-span",e).each((e,t)=>{var r=document.createTextNode("");t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t);var s=t.getAttribute(f);N(l,s,e=>{r.textContent=e})});let i=p("[sv-content]",e);if(delete i.prevObject,i[0]&&(a(l,"$content",{enumerable:!0,get:()=>i[0]._svData?b(i[0]):w(i)}),i.append(n),i.prop("svParent",e),t.childChange)){let r=new MutationObserver(r=>{r.forEach(r=>{let{addedNodes:s,removedNodes:a}=r,n={};0 in s&&(n.addedNodes=Array.from(s)),0 in a&&(n.removedNodes=Array.from(a)),t.childChange(b(e),n)})});r.observe(i[0],{attributes:!1,childList:!0,characterData:!1,subtree:!1}),l.__obs=r}p("[sv-tar]",e).each((e,t)=>{let r=p(t).attr("sv-tar");a(l,"$"+r,{enumerable:!0,get:()=>t._svData?b(t):w([t])})});let d=b(e),c=t.pri;if(c)for(let e in c)d["_"+e]=c[e];let v={};r(v,t.data),t.attrs.forEach(e=>{let t=s.attr(e);(e=>void 0===e)(t)||(v[e]=t),N(l,e,t=>{s.attr(e,t)})}),t.props.forEach(e=>{let t=s.attr(e);v[e]=t}),p("[sv-module]",e).each((e,t)=>{let r=p(t),s=r.attr("sv-module");N(l,s,e=>{t.value=e}),r.on("input",()=>{l[s]=t.value})});let u=t.watch;if(u)for(let e in u)N(l,e,(...t)=>u[e].apply(d,t));let m=t.val;if(m){let t={};m.get&&(t.get=(()=>m.get.call(d))),m.set&&(t.set=(e=>m.set.call(d,e))),a(e,"value",t)}let g=h();s.removeAttr("sv-ele").attr("sv-render",g),s.find('[sv-shadow="t"]').attr("sv-shadow",g),t.render&&t.render(d,v);let{computed:_}=t;if(_)for(let e in _){let t,r,s=_[e];"function"==o(s)?t=s:(t=s.get,r=s.set);let n={enumerable:!0};t&&(n.get=(()=>t.call(d))),r&&(n.set=(s=>{let a=r.call(d,s);return t&&(s=l[e]),O(l,e,s),a})),a(l,e,n),O(l,e,l[e])}l.set(v),t.inited&&t.inited(d),e.getRootNode()===document&&t.attached&&!e._u_attached&&(t.attached(d),e._u_attached=1),p("[sv-ele]",e).each((e,t)=>{D(t)})}},x={register:e=>{function n(e={}){a(this,c,{value:{}}),a(this,v,{value:{}})}let l={tag:"",temp:"<div sv-content></div>",attrs:[],props:[],data:{},proto:{},pri:{}};r(l,e),n.prototype=r(s(j),l.proto);let o=l.temp;var i=(o=o.replace(/<!--.+?-->/g,"")).match(/{{.+?}}/g);i&&i.forEach(e=>{var t=/{{(.+?)}}/.exec(e);t&&(o=o.replace(e,`<sv-span ${f}="${t[1].trim()}"></sv-span>`))});let h=p(`<div>${o}</div>`);h.find("*").attr("sv-shadow","t"),o=h.html(),t[l.tag]=r({Shear:n,code:o},l),p(l.tag+"[sv-ele]").each((e,t)=>{D(t)})}};e.xhear=x,e.$=function(...e){let t=p(...e),[r,s]=e;("string"==o(r)&&r.search("<")>-1||r instanceof Element)&&g(t);let a;s&&(s.getAttribute?a=s.getAttribute("sv-shadow"):s.attr&&(a=s.attr("sv-shadow")));return t=1==(t=a?_(t,a):_(t)).length&&t[0]._svData?b(t[0]):w(t)},r($,p),$.prototype=$.fn=u;const S=(e,r)=>{let s=e[0].tagName.toLowerCase(),a=t[s],n=new Set([...Object.keys(a.data),...a.props,...a.attrs]);i(n,t=>{e[t]=r[t]})},E=e=>{let t=e.attr("sv-render");t&&(e.find(`[sv-shadow="${t}"]:not([sv-content])`).remove(),e.find(`[sv-shadow="${t}"][sv-content]`).each((e,t)=>{p(t).before(t.childNodes).remove()}));e.find("[sv-render]").each((e,t)=>{E(p(t))})},P=(e,t)=>{if(e.is("[sv-shadow]")){let r=e.attr("sv-shadow"),s=o(t);if("string"==s&&t.search("<")>-1){let e=p(t);e.attr("sv-shadow",r),e.find("*").attr("sv-shadow",r),t="",i(e,e=>{t+=e.outerHTML})}else s instanceof Element?p(t).attr("sv-shadow",r):t instanceof $&&p(Array.from(t)).attr("sv-shadow",r)}return t},C=e=>(e.is("[sv-render]")&&(e=e.map((e,t)=>{let r=t,{_svData:s}=t;for(;s&&s.$content;)s=(r=s.$content[0])._svData;return r})),e);r(m,{add(...t){let r=t[0];if(r instanceof e.$&&r.is("sv-shadow"))throw"shadow element can't use add";return u.add.apply(this,t)},attr(...e){let[r,s]=e;if(!s||!this.is("[sv-render]"))return u.attr.apply(this,e);this.each((a,n)=>{let l=n.tagName.toLowerCase(),o=t[l];o&&o.attrs.indexOf(r)>-1?n._svData[r]=s:u.attr.apply(p(n),e)})},clone(...e){if(this.is("[sv-shadow]"))throw"shadow element can't use clone";if(this.svRender){let e=this.html(),t=p(`<div>${e}</div>`);t.find("[sv-render]").each((e,t)=>{p(t).removeAttr("sv-render").attr("sv-ele","")}),e=t.html();this[0].tagName.toLowerCase();let r=this[0].cloneNode();p(r).removeAttr("sv-render").attr("sv-ele","").html(e),D(r);let s=b(r);S(s,this);let a=p("[sv-render]:not([sv-shadow])",this);if(0 in a){let e=p("[sv-render]:not([sv-shadow])",s);e.length==a.length&&e.each((e,t)=>{let r=a[e];if(r.tagName!==t.tagName)return console.warn("cloned sv-ele data does not match"),!1;S(b(t),b(r))})}return s}{let t=this.is("[sv-render]"),r=0 in this.find("[sv-render]");if(t||r){let t=p(Array.from(this)),r=t.clone(...e);E(r),r.find("[sv-render]").removeAttr("sv-render").attr("sv-ele",""),g(r),t.each((e,t)=>{n(t,"sv-render")&&(r[e]=b(t).clone()[0])});let s=e=>{let s=r.find(e);if(0 in s){let r=t.find(e);s.length==r.length&&r.each((e,t)=>{S(b(s[e]),b(t))})}};return s("[sv-render]:not([sv-shadow])"),s("[sv-render][sv-shadow]"),this.prevObject&&(r.prevObject=this),w(r)}u.clone.apply(this,e)}},empty(){return u.empty.call(C(this)),this},parent(e){let t=this.map((e,t)=>{let r=t.parentNode;for(;r.svParent;)r=r.svParent;return r}),r=w(new Set(t));return e&&(r=r.filter(e)),r},parents(e){let t=[];this.each((e,r)=>{let s=r.parentNode;for(;s&&s!==document;){for(;s.svParent;)s=s.svParent;t.push(s),s=s.parentNode}});let r=w(new Set(t));return e&&(r=r.filter(e)),r},parentsUntil(e){let t=[];return this.each((r,s)=>{let a=s.parentNode;for(;a&&a!==document;){for(;a.svParent;)a=a.svParent;if(e&&p(a).is(e))break;t.push(a),a=a.parentNode}}),w(new Set(t))},unwrap(){let e=p(this).parent();return e.is("[sv-content]")?e.each((e,t)=>{let{svParent:r}=t;r=p(r?r:t);let s=t.childNodes;i(s,e=>{r.before(e)}),r.remove()}):u.unwrap.call(this),this}}),i(["after","before","wrap","wrapAll","replaceWith"],e=>{let t=u[e];t&&(m[e]=function(e){return t.call(this,P(this,e)),this})}),i(["insertAfter","insertBefore","replaceAll"],e=>{let t=u[e];t&&(m[e]=function(r){if(this.is("[sv-shadow]"))throw"shadow element can't use "+e;return t.call(P(p(r),this),r),this})}),i(["append","prepend","wrapInner"],e=>{let t=u[e];t&&(m[e]=function(e){return t.call(C(this),P(this,e)),this})}),i(["appendTo","prependTo"],e=>{let t=u[e];t&&(m[e]=function(r){if(this.is("[sv-shadow]"))throw"shadow element can't use "+e;let s=p(r);return s.is("[sv-shadow]")&&P(s,this),t.call(this,C(s)),this})}),i(["find","children"],e=>{u[e]&&(m[e]=function(t){let r=u[e].call(C(this),t);return 1==r.length&&r[0]._svData?r=b(r[0]):(r=this.is("[sv-shadow]")?_(r,this.attr("sv-shadow")):_(r),r=w(r)),r})}),i(["eq","first","last","filter","has","not","slice","next","nextAll","nextUntil","prev","prevAll","prevUntil","siblings"],e=>{u[e]&&(m[e]=function(...t){let r=u[e].apply(this,t),s=r[0];return 1===r.length&&s._svData&&(r=b(s)),r})}),i(["html","text"],e=>{let t=u[e];t&&(m[e]=function(r){let s=this;if(r)return"text"!==e&&(r=P(this,r)),t.call(C(this),r),s;{let e=p(s[0]);if(0 in e.find("[sv-shadow]")){let r=p(e[0].cloneNode(!0));return E(r),t.call(r)}return t.call(e)}})}),(()=>{let{pushStack:e}=u;e&&(m.pushStack=function(...t){return w(e.apply(this,t))})})(),p(()=>{p("[sv-ele]").each((e,t)=>{D(t)});const e=e=>{if(e._u_attached)return;let t=y(e);t.attached&&t.attached(b(e)),e._u_attached=1},t=e=>{if(e.getRootNode()!=document){let t=y(e);t.detached&&t.detached(b(e)),p("[sv-content]",e).each((e,t)=>{delete t.svParent});let{_svData:r}=e;r&&(r.__obs&&r.__obs.disconnect(),delete r.__obs,delete e._svData)}};new MutationObserver(r=>{r.forEach(r=>{let{addedNodes:s,removedNodes:a}=r;s&&0 in s&&i(Array.from(s),t=>{t._svData&&e(t),t instanceof Element&&(i(Array.from(t.querySelectorAll("[sv-ele]")),e=>{D(e)}),i(Array.from(t.querySelectorAll("[sv-render]")),t=>{e(t)}))}),a&&0 in a&&i(Array.from(a),e=>{e._svData&&t(e),p("[sv-render]",e).each((e,r)=>{t(r)})})})}).observe(document.body,{attributes:!1,childList:!0,characterData:!1,subtree:!0})}),p("head").append("<style>[sv-ele]{display:none}[sv-render]{display:block}</style>")})(window);