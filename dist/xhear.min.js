/*!
* xhear v6.0.0
* https://github.com/kirakiray/Xhear#readme
* 
* (c) 2018-2021 YAO
* Released under the MIT License.
*/(e=>{"use strict";const t=()=>Math.random().toString(32).substr(2);var r=Object.prototype.toString,s=e=>r.call(e).toLowerCase().replace(/(\[object )|(])/g,"");const n=e=>s(e).search("function")>-1;const i=Object.defineProperties,l=Object.getOwnPropertyDescriptor,o=e=>e instanceof g,a=null!==document.currentScript.getAttribute("debug"),h=(()=>{if(a){let e=new Map;return(r,s)=>{s||(s=t());let n=e.get(s);clearTimeout(n),e.set(s,setTimeout(()=>{r(),e.delete(s)}))}}let e=new Map,r=e=>Promise.resolve().then(()=>e());"object"==typeof process&&process.nextTick&&(r=process.nextTick);let s=!1;return(n,i)=>{i||(i=t()),e.set(i,{key:i,fun:n}),s||(s=!0,r(()=>{e.size&&e.forEach(({key:t,fun:r})=>{try{r()}catch(e){console.error(e)}e.delete(t)}),e.clear(),s=!1}))}})(),c=(e,t)=>{Object.keys(t).forEach(r=>{let{get:s,set:n,value:i}=l(t,r);i?e.hasOwnProperty(r)?e[r]=i:Object.defineProperty(e,r,{value:i}):Object.defineProperty(e,r,{get:s,set:n})})},u=(Date.now(),Symbol("self")),f=Symbol("watchs"),p=Symbol("can_update"),d=(e,t)=>{e[f].forEach(e=>e(t)),e.owner.forEach(e=>d(e,t))};class g{constructor(e){if(o(e))return e;let r;e.get?(r=new Proxy(this,{get:e.get,ownKeys:e.ownKeys,getOwnPropertyDescriptor:e.getOwnPropertyDescriptor,set:y.set}),delete e.get,delete e.ownKeys,delete e.getOwnPropertyDescriptor):r=new Proxy(this,y),i(this,{[u]:{value:this},xid:{value:"x_"+t()},owner:{value:new Set},length:{configurable:!0,writable:!0,value:0},[f]:{value:new Map},[p]:{writable:!0,value:0}});let s=-1;return Object.keys(e).forEach(t=>{let r=l(e,t),{value:n,get:o,set:a}=r;"get"!==t&&(/\D/.test(t)||(t=parseInt(t))>s&&(s=t),o||a?i(this,{[t]:r}):this.setData(t,n))}),s>-1&&(this.length=s+1),this[p]=1,r}watch(e){const r="e_"+t();return this[f].set(r,e),r}unwatch(e){return this[f].delete(e)}setData(e,t){if(/^_/.test(e))return i(this,{[e]:{writable:!0,configurable:!0,value:t}}),!0;let r=s(t);"array"!=r&&"object"!=r||(t=new g(t,this)).owner.add(this);const n=this[e];let l=Reflect.set(this,e,t);return(this[p]||!1===this._update)&&d(this,{xid:this.xid,name:"setData",args:[e,t]}),o(n)&&n.owner.delete(this),l}delete(e){if(/^_/.test(e)||"symbol"==typeof e)return Reflect.deleteProperty(this,e);if(!e)return!1;const t=this[u];let r=t[e];o(r)&&r.owner.delete(t);let s=Reflect.deleteProperty(t,e);return d(this,{xid:this.xid,name:"delete",args:[e]}),s}}const y={set:(e,t,r,s)=>"symbol"==typeof t?Reflect.set(e,t,r,s):e.setData(t,r),deleteProperty:function(e,t){return e.delete(t)}};c(g.prototype,{seek(e){let t=[];if(!n(e)){let t=new Function(`with(this){return ${e}}`);e=(e=>{try{return t.call(e,e)}catch(e){}})}return e.call(this,this)&&t.push(this),Object.values(this).forEach(r=>{o(r)&&t.push(...r.seek(e))}),t},watchTick(e){return this.watch((e=>{let t=[];const r=s=>{t.push(s),h(()=>{e(t),t.length=0},r)};return r})(e))},toJSON(){let e={},t=!0,r=0;Object.keys(this).forEach(s=>{let n=this[s];/\D/.test(s)?t=!1:(s=parseInt(s))>r&&(r=s),o(n)&&(n=n.toJSON()),e[s]=n}),t&&(e.length=r+1,e=Array.from(e));const s=this.xid;return i(e,{xid:{get:()=>s}}),e},toString(){return JSON.stringify(this.toJSON())}}),["concat","every","filter","find","findIndex","forEach","map","slice","some","indexOf","lastIndexOf","includes","join"].forEach(e=>{let t=Array.prototype[e];t&&i(g.prototype,{[e]:{value:t}})});const m=Array.prototype.splice;c(g.prototype,{splice(e,t,...r){let n=this[u];r=r.map(e=>{let t=s(e);return"array"!=t&&"object"!=t||(e=new g(e)).owner.add(n),e});let i=m.call(n,e,t,...r);return i.forEach(e=>o(e)&&e.owner.delete(n)),d(this,{xid:this.xid,name:"splice",args:[e,t,...r]}),i},unshift(...e){return this.splice(0,0,...e),this.length},push(...e){return this.splice(this.length,0,...e),this.length},shift(){return this.splice(0,1)[0]},pop(){return this.splice(this.length-1,1)[0]}}),["sort","reverse"].forEach(e=>{const t=Array.prototype[e];t&&i(g.prototype,{[e]:{value(...r){let s=t.apply(this[u],r);return d(this,{xid:this.xid,name:e}),s}}})});const w=e=>e.__xEle__?e.__xEle__:e.__xEle__=new _(e),b=document.createElement("template"),x=(e,t)=>!!e.tagName&&(e===t||e!==document&&(b.innerHTML=`<${e.tagName.toLowerCase()} ${Array.from(e.attributes).map(e=>e.name+'="'+e.value+'"').join(" ")} />`,!!b.content.querySelector(t))),v=document.createElement("div"),O=e=>{return v.innerHTML=e,Array.from(v.children).map(function(e){return v.removeChild(e),e})},E=e=>{if(!e.tag)throw console.error("this data need tag =>",e),"";let t=document.createElement(e.tag);e.class&&t.setAttribute("class",e.class),e.slot&&t.setAttribute("slot",e.slot),e.text&&(t.textContent=e.text);let r=0;for(;r in e;){let s=E(e[r]);t.appendChild(s),r++}return t},S={get:(e,t,r)=>"string"!=typeof t||/\D/.test(t)?Reflect.get(e,t,r):w(e.ele.children[t]),ownKeys(e){let t=Reflect.ownKeys(e),r=e.ele.children.length;for(let e=0;e<r;e++)t.push(String(e));return t},getOwnPropertyDescriptor:(e,t)=>"string"!=typeof t||/\D/.test(t)?Reflect.getOwnPropertyDescriptor(e,t):{enumerable:!0,configurable:!0}},j=Symbol("events");class _ extends g{constructor(e){super(Object.assign({tag:e.tagName.toLowerCase()},S)),i(this,{ele:{get:()=>e},[j]:{writable:!0,value:""}}),delete this.length,this._update=0}get parent(){let{parentNode:e}=this.ele;return e&&e!==document?w(e):null}get length(){return this.ele.children.length}get text(){return this.ele.textContent}set text(e){this.ele.textContent=e}get html(){return this.ele.innerHTML}set html(e){this.ele.innerHTML=e}get class(){return this.ele.classList}get data(){return this.ele.dataset}get css(){return getComputedStyle(this.ele)}get style(){return this.ele.style}set style(e){if("string"==s(e))return void(this.ele.style=e);let{style:t}=this,r=Array.from(t),n=Object.keys(e);r.forEach(e=>{n.includes(e)||(t[e]="")}),Object.assign(t,e)}get display(){return getComputedStyle(this.ele).display}set display(e){this.ele.style.display=e}get position(){return{top:this.ele.offsetTop,left:this.ele.offsetLeft}}get offset(){let e={top:0,left:0},t=this.ele;for(;t&&t!==document;)e.top+=t.offsetTop,e.left+=t.offsetLeft,t=t.offsetParent;return e}get width(){return parseInt(getComputedStyle(this.ele).width)}get height(){return parseInt(getComputedStyle(this.ele).height)}get innerWidth(){return this.ele.clientWidth}get innerHeight(){return this.ele.clientHeight}get offsetWidth(){return this.ele.offsetWidth}get offsetHeight(){return this.ele.offsetHeight}get outerWidth(){let e=getComputedStyle(this.ele);return this.ele.offsetWidth+parseInt(e["margin-left"])+parseInt(e["margin-right"])}get outerHeight(){let e=getComputedStyle(this.ele);return this.ele.offsetHeight+parseInt(e["margin-top"])+parseInt(e["margin-bottom"])}$(e){return w(this.ele.querySelector(e))}all(e){return Array.from(this.ele.children).map(e=>w(e))}is(e){return x(this.ele,e)}attr(...e){let[t,r]=e,{ele:s}=this;if(1==e.length)return t instanceof Object&&Object.keys(t).forEach(e=>{s.setAttribute(e,t[e])}),s.getAttribute(t);s.setAttribute(t,r)}siblings(e){let t=Array.from(this.parent.ele.children),r=t.indexOf(this.ele);return t.splice(r,1),e&&(t=t.filter(t=>{if(x(t,e))return!0})),t.map(e=>w(e))}parents(e,t){let r=[],n=this.parent;if(e){if("string"==s(e))for(;n&&n;)x(n.ele,e)&&r.push(n),n=n.parent}else for(;n;)r.push(n),n=n.parent;if(t)if(t instanceof XhearEle){let e=[];r.some(r=>{if(r===t)return!0;e.push(r)}),r=e}else if("string"==s(t)){let e=[];r.some(r=>{if(r.is(t))return!0;e.push(r)}),r=e}return r}clone(){let e=w(this.ele.cloneNode(!0));return Object.keys(this).forEach(t=>{"tag"!==t&&(e[t]=this[t])}),e}splice(e,t,...r){const{ele:n}=this,i=Array.from(n.children),l=[];let o=e,a=t,h=i[o];for(;h&&a>0;)l.push(h),n.removeChild(h),a--,h=i[++o];if(r.length){let t=document.createDocumentFragment();r.forEach(e=>{if(e instanceof Element)return void t.appendChild(e);let r=s(e);"string"==r?O(e).forEach(e=>{t.appendChild(e)}):"object"==r&&t.appendChild(E(e))}),e>=this.length?n.appendChild(t):n.insertBefore(t,n.children[e])}return l}}const C=e=>e[j]?e[j]:e[j]=new Map;function A(e){if(e instanceof Element)return w(e);const t=s(e);return"string"==t?/\<.+\>/.test(e)?w(O(e)[0]):w(document.querySelector(e)):"object"==t?w(E(e)):null}c(_.prototype,{on(e,r,s){if(n(r)){s=r,r=void 0,this.ele.addEventListener(e,s);const n="e_"+t();return C(this).set(n,{name:e,selector:r,callback:s}),n}},off(e){let t=C(this).get(e);return!!t&&(this.ele.removeEventListener(t.name,t.callback),this[j].delete(e),!0)},one(e,t,r){let s,n;return"string"==typeof t?(n=r,r=(e=>{n(e),this.off(s)})):(n=t,t=(e=>{n(e),this.off(s)})),s=this.on(e,t,r)},emit(e,t){},emitHandler(e,t){}}),A.all=(e=>Array.from(document.querySelectorAll(e)).map(e=>w(e))),e.$=A})(window);