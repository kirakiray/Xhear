(e=>{"use strict";function t(e=[]){p(this,e)}if(e.$)return;const r=document;let n=Object.prototype.toString;const s=e=>n.call(e).toLowerCase().replace(/(\[object )|(])/g,""),i=e=>s(e).search("function")>-1,a=e=>"string"===s(e),l=e=>void 0===e,o=e=>!l(e)&&"number"===s(e.length)&&e.length>=0&&!i(e)&&!a(e),h=e=>e instanceof Element,{defineProperty:d,assign:c}=Object,u=e=>Array.from(e),p=(e,t)=>e.splice(e.length,0,...t),f=(e,t)=>{let r=e.indexOf(t);r>-1&&e.splice(r,1)},v=(e,t)=>e.some((e,r)=>!1===t(e,r)),m=getComputedStyle,x=(e,t)=>{let r=e.split(" ");v(r,e=>t(e))},g="XQUE_"+Math.random().toString(32).substr(2),y=g+"_event",b=(e,t,r,n,s)=>{let a=i(t);if(l(t)){if(s)return n(e[0])}else v(e,(e,s)=>{let i;i=a?t.call(e,s,n&&n(e)):t,l(i)||r(e,i,s)});return e},w=(e,t,r,n)=>{let[a,o]=t;if("object"==s(a))for(let t in a)v(e,e=>{r(e,t,a[t])});else if(i(o))v(e,(e,t)=>{o.call(e,t,n(e,a))});else{if(l(o))return n(e[0],a);v(e,e=>{r(e,...t)})}return e},_=e=>"number"==s(e)?e+"px":e,O=(e,t=r)=>u(t.querySelectorAll(e)),E=e=>{let t=r.createElement("div");t.innerHTML=e;return u(t.childNodes).filter(function(e){if(!(e instanceof Text)||e.textContent&&e.textContent.trim())return e})},k=(e,t)=>{if(e===t)return!0;let n=r.createElement("div");return e!==r&&(n.appendChild(e.cloneNode(!1)),0 in O(t,n))},N=e=>e[g]||(e[g]={}),j=e=>e[y]||(e[y]={});let A=Object.create(Array.prototype);c(A,{attr(...e){return w(this,e,(e,t,r)=>{e.setAttribute(t,r)},(e,t)=>e.getAttribute(t))},removeAttr(e){return b(this,e,(e,t)=>{x(t,t=>{e.removeAttribute(t)})})},prop(...e){return w(this,e,(e,t,r)=>{e[t]=r},(e,t)=>e[t])},removeProp(e){return b(this,e,(e,t)=>{x(t,t=>{delete e[t]})})},data(...e){return w(this,e,(e,t,r)=>{N(e)[t]=r},(e,t)=>{let r={};return c(r,e.dataset),c(r,N(e)),r[t]})},removeData(e){return b(this,e,(e,t)=>{x(t,t=>{delete N(e)[t]})})},css(...e){return w(this,e,(e,t,r)=>{String(m(e)[t]).indexOf("px")>-1&&(r=_(r)),e.style[t]=r},(e,t)=>m(e)[t])},text(e){return b(this,e,(e,t)=>{e.textContent=t},e=>e.textContent,1)},html(e){return b(this,e,(e,t)=>{e.innerHTML=t},e=>e.innerHTML,1)},val(e){return b(this,e,(e,t)=>{e.value=t},e=>e.value,1)},each(e){return v(this,(t,r)=>{e.call(t,r,t)}),this},index(e){let t,r;return e?e.nodeType?(r=e,t=this):e instanceof S?(r=e[0],t=this):"string"===s(e)&&(r=this[0],t=S(e)):(r=this[0],t=u(r.parentNode.children)),t.indexOf(r)},extend(e){c(A,e)}});let P={addClass(e,t){e.classList.add(t)},removeClass(e,t){e.classList.remove(t)},toggleClass(e,t){e.classList.toggle(t)}};for(let e in P){let t=P[e];A[e]=function(e){return b(this,e,(e,r)=>{x(r,r=>{t(e,r)})},e=>e.classList.value)}}const L=(e,t)=>{o(e)?v(u(e),e=>{t(e)}):t(e)};let S=function(e,n){let a=[];switch(s(e)){case"string":e.search("<")>-1?a=E(e):L(n,t=>{let r=O(e,t);p(a,r)});break;case"array":a=e;break;default:e instanceof Element?a=[e]:o(e)?a=u(e):i(e)?("complete"===r.readyState?e(S):r.addEventListener("DOMContentLoaded",function(){e(S)},!1),a=[r]):e&&(n&&h(e)?L(n,t=>{let r=e.tagName.toLowerCase(),n=O(r,t);v(n,t=>{e===t&&a.push(t)})}):a=[e])}return new t(a)};const C=(e,t,r)=>{let n=e.length;return b(e,t,(e,t)=>{let i=s(t);n--;let a=t;"string"===i?a=E(t):h(t)&&(a=[t]),n>0&&(a=[].map.call(a,e=>e.cloneNode(!0))),v(a,t=>{r(e,t)})},e=>e.innerHTML)},T=(e,t)=>{e[g]=c({},N(t));let r=j(t),n=j(e);for(let t in r){let s=r[t],i=n[t]=[];v(s,r=>{let n=c({},r);i.push(n),e.addEventListener(t,n.handle)})}},$=(e,t)=>{let r=Array.from(e.children),n=t.children;v(r,(e,t)=>{let r=n[t];T(e,r),$(e,r)})};Object.assign(A,{append(e){return C(this,e,(e,t)=>{e.appendChild(t)})},prepend(e){return C(this,e,(e,t)=>{e.insertBefore(t,e.firstChild)})},before(e){return C(this,e,(e,t)=>{e.parentNode.insertBefore(t,e)})},after(e){return C(this,e,(e,t)=>{var r=e.parentNode;r.lastChild===e?r.appendChild(t):r.insertBefore(t,e.nextSibling)})},wrap(e){return C(this,e,(e,t)=>{e.parentNode.insertBefore(t,e),t.appendChild(e)})},unwrap(){var e=[];return v(this,function(t){var r=t.parentNode;r.parentNode.insertBefore(t,r),-1===e.indexOf(r)&&e.push(r)}),S(e).remove(),this},wrapInner(e){return C(this,e,(e,t)=>{v(u(e.childNodes),function(e){t.appendChild(e)}),e.appendChild(t)})},wrapAll(e){a(e)&&(e=E(e));return this.eq(0).before(e=S(e)),v(this,t=>e.append(t)),this},replaceWith(e){return this.before(e).remove()},empty(){v(this,e=>{e.innerHTML=""})},remove(e){v(this,t=>{e&&!k(t,e)||t.parentNode.removeChild(t)})},clone(e,t){return this.map((r,n)=>{let s=n.cloneNode(!0);return e&&T(s,n),t&&$(s,n),s})}});let D={append:"appendTo",prepend:"prependTo",after:"insertAfter",before:"insertBefore",replaceWith:"replaceAll"};for(let e in D){A[D[e]]=function(t){S(t)[e](this)}}const R=(e,t)=>parseFloat(m(e)[t]);v([{Width:["left","right"]},{Height:["top","bottom"]}],e=>{for(let t in e){let r=t.toLowerCase();A[r]=function(e){return b(this,e,(e,t)=>{t=_(t),e.style[r]=t},e=>R(e,r),1)};let n=e[t],s=(e,t,s,i)=>{let a=R(e,r);return v(n,r=>{t&&(a+=R(e,"padding-"+r)),s&&(a+=R(e,"border-"+r+"-width")),i&&(a+=R(e,"margin-"+r))}),a};A["inner"+t]=function(){return s(this[0],1)};A["outer"+t]=function(e){return s(this[0],1,1,e)}}}),Object.assign(A,{offset(){let e=this[0],t=0,r=0;do{t+=e.offsetTop,r+=e.offsetLeft,e=e.offsetParent}while(e);return{top:t,left:r}},position(){let e=this[0];return{top:e.offsetTop,left:e.offsetLeft}},scrollTop(e){return b(this,e,(e,t)=>{e.scrollTop=t},e=>e.scrollTop,1)},scrollLeft(e){return b(this,e,(e,t)=>{e.scrollLeft=t},e=>e.scrollLeft,1)}});const U=(e,t,r,n)=>{let s=[];return a(t)?v(e,e=>{k(e,t)?r&&r(s,e):n&&n(s,e)}):o(t)?v(e,e=>{v(t,t=>{e===t?r&&r(s,e):n&&n(s,e)})}):h(t)?v(e,e=>{t===e?r&&r(s,e):n&&n(s,e)}):i(t)&&v(e,(e,i)=>{t.call(e,i,e)?r&&r(s,e):n&&n(s,e)}),S(s)},H=(e,t,r)=>{let n=[];return v(r,r=>{!(r=r[t])||-1!=n.indexOf(r)||e&&!k(r,e)||n.push(r)}),S(n)},M=(e,t,r,n)=>{let i=[],a=e=>{let l=e[t];if(l){if(n&&("string"===s(n)&&k(l,n)||n===l||n instanceof Array&&n.indexOf(l)>-1))return;r&&!k(l,r)||-1!==i.indexOf(l)||i.push(l),a(l)}};return v(e,e=>{a(e)}),a=null,S(i)};c(A,{slice(...e){let t=[].slice.call(this,...e);return S(t)},eq(e){return this.slice(e,e+1||void 0)},first(){return this.eq(0)},last(){return this.eq(-1)},get(e){return l(e)?u(this):this[e]},hasClass(e){let t=!1;return v(this,r=>{r.classList.contains(e)&&(t=!0)}),t},filter(e){return U(this,e,(e,t)=>e.push(t))},not(e){return U(this,e,0,(e,t)=>e.push(t))},is(e){return 0 in this.filter(e)},map(e){let t=[];return v(this,(r,n)=>{t.push(e(n,r))}),S(t)},find(e){return S(e,this)},has(e){let t=[];return v(this,r=>{0 in S(e,r)&&t.push(r)}),S(t)},children(e){let t=[];return v(this,r=>{r.nodeType&&v(u(r.children),r=>{e?k(r,e)&&t.push(r):t.push(r)})}),S(t)},next(e){return H(e,"nextElementSibling",this)},prev(e){return H(e,"previousElementSibling",this)},parent(e){return H(e,"parentNode",this)},nextAll(e){return M(this,"nextElementSibling",e)},prevAll(e){return M(this,"previousElementSibling",e)},parents(e){return M(this,"parentNode",e,r)},nextUntil(e,t){return M(this,"nextElementSibling",t,e)},prevUntil(e,t){return M(this,"previousElementSibling",t,e)},parentsUntil(e,t){return M(this,"parentNode",t,e)},closest(e){var t=S(e).parent();return this.parentsUntil(t,e)},siblings(e){let t=this;return this.parent().children(e).filter(function(){if(-1===t.indexOf(this))return!0})},offsetParent(){let e=[];return v(this,t=>{e.push(t.offsetParent||r.body)}),S(e)}});let q={preventDefault(){this._pD()},isDefaultPrevented(){return this.defaultPrevented},stopPropagation(){this._sP()},isPropagationStopped(){return this.cancelBubble},stopImmediatePropagation(){this.isImmediatePropagationStopped=(()=>!0),this._sIP()},isImmediatePropagationStopped:()=>!1};const I=e=>(e._pD||(Object.defineProperties(e,{_pD:{value:e.preventDefault},_sP:{value:e.stopPropagation},_sIP:{value:e.stopImmediatePropagation}}),Object.assign(e,q)),e);let B=MouseEvent,W=TouchEvent,F={click:B,mousedown:B,mouseup:B,mousemove:B,mouseenter:B,mouseleave:B,touchstart:W,touchend:W,touchmove:W},J=["focus","blur"],X=S.Event=((e,t)=>{let r=F[e]||Event;return I(new r(e,t))});const G=(e,t)=>{let r=j(e);return r[t]||(r[t]=[])},V=(e,t,r,n)=>(v(e,e=>{if(h(e)){if(!n&&!r&&J.indexOf(t)>-1&&i(e[t]))return void e[t]();let s;s=t instanceof Event?t:n?new Event(t,{bubbles:!1,cancelable:!0}):X(t,{bubbles:!0,cancelable:!0}),r&&d(s,"_argData",{value:r}),e.dispatchEvent(s)}else{let n=G(e,t),s=[],i=0;v(n,e=>{if(e.isOne||s.push(e),i)return;let n=X(t),a=[n];r&&a.push(r);let o=e.data;l(o)||(n.data=o),e.fn(...a),delete n.data,n.isImmediatePropagationStopped()&&(i=1)});j(e)[t]=s}}),e),K=(e,t,r,n,s,d)=>{if(t=t.split(" "),i(r)?(s=r,r=n=void 0):a(r)?i(n)&&(s=n,n=void 0):(s=n,n=r,r=void 0),s)return v(e,e=>{v(t,t=>{let i={fn:s,isOne:d,data:n,selector:r};if(h(e)){let a=function(i){I(i),!l(n)&&(i.data=n),i.originalEvent=i;let h=i._argData;h&&!o(h)&&(h=[h]);let c=this,u=1;if(r){let e=S(i.target).parents(r);0 in e?c=e[0]:k(i.target,r)?c=i.target:u=0}u&&(h?s.call(c,i,...h):s.call(c,i)),delete i.data,delete i.originalEvent,d&&e.removeEventListener(t,a)};i.handle=a,e.addEventListener(t,a)}G(e,t).push(i)})}),e;console.error("no function =>",s)};Object.assign(A,{on(e,t,r,n){return K(this,e,t,r,n)},one(e,t,r){return K(this,e,void 0,t,r,1)},off(e,t,r){return((e,t,r,n)=>(t&&(t=t.split(" "),!n&&i(r)&&(n=r,r=void 0)),v(e,e=>{let s=j(e);if(t)v(t,t=>{let i=G(e,t);if(h(e))if(n){let s=i.find(function(e){return e.fn===n&&e.selector===r});s&&(e.removeEventListener(t,s.handle),f(i,s))}else v(i,r=>{e.removeEventListener(t,r.handle)}),s[t]=[];else n?f(i,n):s[t]=[]});else{if(h(e))for(let t in s){let r=s[t];v(r,r=>{e.removeEventListener(t,r.handle)})}e[y]={}}}),e))(this,e,t,r)},trigger(e,t){return V(this,e,t)},triggerHandler(e,t){return V(this,e,t,1)},bind(e,t,r){return this.on(e,t,r)},unbind(e,t){return this.off(e,t)},hover(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),v("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e){A[e]=function(t){return t?this.on(e,t):this.trigger(e),this}});let z={url:"",type:"GET",data:"",crossDomain:!1,dataType:"",headers:{},timeout:1e5,username:null,password:null,contentType:"json"};const Q=e=>{let t=c({},z);c(t,e),t.type=t.type.toUpperCase();let{url:r,contentType:n,data:s}=t;if(s instanceof FormData)n="form";else if(n.indexOf("form")>-1){let e=new FormData;for(let t in s)e.append(t,s[t]);s=e}switch(t.type){case"GET":n="";let e=Y(s);r+=(r.indexOf("?")>-1?r+="&":"?")+e,s=null;break;case"POST":n.indexOf("json")>-1?(n="application/json; charset=UTF-8",s=JSON.stringify(s)):n.indexOf("urlencoded")>-1?(n="application/x-www-form-urlencoded; charset=UTF-8",s=Y(s)):n.indexOf("form")>-1?n="multipart/form-data; charset=UTF-8":n.indexOf("xml")>-1&&(n="text/xml; charset=UTF-8")}let i=S({});var a=new XMLHttpRequest;let l=new Promise((e,s)=>{a.open(t.type,r,!0,t.username,t.password);let{headers:l}=t;for(let e in l)a.setRequestHeader(e,l[e]);n&&a.setRequestHeader("Content-Type",n),a.responseType=t.dataType,a.withCredentials=t.crossDomain,a.timeout=t.timeout,a.addEventListener("load",t=>{let{target:r}=t,{response:n}=t.target,s=r.getResponseHeader("content-type");s&&s.indexOf("application/json")>-1&&"object"!=typeof n&&(n=JSON.parse(n)),e(n)},!1),a.addEventListener("error",e=>{s()},!1),a.addEventListener("progress",e=>{i.trigger("loading",e)},!1),a.upload&&a.upload.addEventListener("progress",e=>{i.trigger("uploading",e)},!1)});return c(l,{loading:e=>(i.on("loading",(t,r)=>e(r)),l),uploading:e=>(i.on("uploading",(t,r)=>e(r)),l),beforeSend:e=>(e(a),l)}),setTimeout(()=>{s?a.send(s):a.send()},0),l.options=t,l},Y=(e,t="",r)=>{let n="";for(let s in e){let i=e[s];"object"==typeof i?n+=t?Y(i,`${t}[${s}]`,r):Y(i,s,r):(t&&(e instanceof Array&&(s=""),s=t+`[${s}]`),r||(s=encodeURIComponent(s),i=encodeURIComponent(i)),n+=`${s}=${i}&`)}return t||(n=n.replace(/&$/g,"")),n};c(S,{ajax:Q,ajaxSetup:e=>{c(z,e)},param:e=>Y(e,"",1)}),v(["get","post"],e=>{S[e]=((t,r,n)=>{let s={url:t,type:e.toUpperCase(),data:r};return n&&(s.dataType=n),Q(s)})}),c(A,{show(){return v(this,e=>{e.style.display=""}),this},hide(){return v(this,e=>{e.style.display="none"}),this}}),S.prototype=S.fn=t.prototype=A,c(S,{extend(...e){if(1!==e.length)return c(...e);{let t=e[0];"object"==s(t)&&c(S,t)}},merge:p,type:s}),e.Xque=e.$=S})(window),(e=>{"use strict";function t(e,t,r,n){h(this,{_id:{value:n||v()},_obs:{value:[]},_trend:{value:[]},_syncs:{value:[]},_watch:{value:{}},_canEmitWatch:{writable:!0,value:0},isRoot:{value:!!e}}),e?h(this,{_root:{value:e},_host:{value:t},_hostkey:{value:r}}):o(this,"_cache",{value:{}})}function r(...e){t.apply(this,e)}let n=e.$,s=n.fn,i={};e.tagDatabase=i;const{assign:a,create:l,defineProperty:o,defineProperties:h}=Object;let d=e=>void 0!==e&&null!==e;const c=(e,t)=>{if(!e.getAttribute)return!1;let r=e.getAttribute(t);return null!==r&&void 0!==r||void 0};let u=Object.prototype.toString;const p=e=>u.call(e).toLowerCase().replace(/(\[object )|(])/g,""),f=(e,t)=>Array.from(e).forEach(t),v=()=>Math.random().toString(32).substr(2),m=((()=>{let e=!1,t=[]})(),v(),v()+"_xhearobj"),x=v()+"_attached",g=e=>{let t=e.tagName.toLowerCase();return i[t]},y=e=>{let t=e[m],r=l(t);return r.push(e),r},b=e=>1==e.length&&e[0][m]?y(e[0]):(e=>{let t=l(_);return t.splice(-1,0,...e),e.prevObject&&(t.prevObject=e.prevObject),t})(e),w=e=>{e.is("[xv-ele]")&&e.each((e,t)=>{E(t)}),n("[xv-ele]",Array.from(e)).each((e,t)=>{E(t)})};let _=l(s),O=100;const E=e=>{if(!c(e,"xv-ele"))return;let t=g(e);if(!t)return void console.warn("no exist tag",e);let r=n(e),s=Array.from(e.childNodes);e.innerHTML=t.temp;let i=++O,l=new t.XHear;l._canEmitWatch=1;let h=new Proxy(l,P);e[m]=h;let u=y(e);r.removeAttr("xv-ele").attr("xv-render",i),r.find("*").attr("xv-shadow",i),n(`[xv-ele][xv-shadow="${i}"]`,e).each((e,t)=>{E(t)}),n(`xv-span[xv-shadow="${i}"]`,e).each((e,t)=>{var r=document.createTextNode("");t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t);var n=t.getAttribute("svkey");h.watch(n,e=>{r.textContent=e})});let f=n(`[xv-content][xv-shadow="${i}"]`,e);if(0 in f&&(o(h,"$content",{enumerable:!0,get:()=>b(f)}),f.prop("svParent",e),f.append(s),t.childChange)){let r=new MutationObserver(r=>{r.forEach(r=>{let{addedNodes:n,removedNodes:s}=r,i={};0 in n&&(i.addedNodes=Array.from(n)),0 in s&&(i.removedNodes=Array.from(s)),t.childChange(y(e),i)})});r.observe(f[0],{attributes:!1,childList:!0,characterData:!1,subtree:!1}),h.__obs=r}n(`[xv-tar][xv-shadow="${i}"]`,e).each((e,t)=>{let r=n(t).attr("xv-tar");o(h,"$"+r,{enumerable:!0,get:()=>b([t])})});let v=a({},t.data);t.attrs.forEach(e=>{let t=r.attr(e);d(t)&&(v[e]=t),h.watch(e,t=>{r.attr(e,t)})}),t.props.forEach(e=>{let t=r.attr(e);d(t)&&(v[e]=t)}),n(`[xv-module][xv-shadow="${i}"]`,e).each((e,t)=>{let r=n(t),s=r.attr("xv-module");h.watch(s,e=>{t.value=e}),t[m]?t[m].watch("value",e=>{h[s]=e}):r.on("change input",e=>{h[s]=t.value})}),r.removeAttr("xv-ele").attr("xv-render",i);let w=t.watch;if(w)for(let e in w)e in v||(v[e]=void 0);if(l._exkeys=Object.keys(v),w)for(let e in w){let t,r,n=w[e];switch(p(n)){case"function":r=n;break;case"object":t=n.get,r=n.set}t&&watchGetter(h,e,t.bind(u)),r&&h.watch(e,r.bind(u))}"value"in v&&o(e,"value",{get:()=>h.value,set(e){h.value=e}});for(let e in v)d(v[e])&&(h[e]=v[e]);t.inited&&t.inited.call(e,u),t.attached&&e.getRootNode()===document&&!e[x]&&(t.attached.call(e,u),e[x]=1)};let k=function(...e){let t=n(...e),[r,s]=e;("string"==p(r)&&r.search("<")>-1||r instanceof Element)&&w(t);let i;return s&&(s.getAttribute?i=s.getAttribute("xv-shadow"):s.attr&&(i=s.attr("xv-shadow"))),t=i?H(t,i):H(t),t=b(t)};k.prototype=s,a(k,{init:(...e)=>b(e)},n);let N=e=>e instanceof t||e instanceof r,j=(e,t)=>{let r=e;if(e instanceof Array)r=[],e.forEach(e=>{N(e)?r.push(j(e,t)):r.push(e)});else if(e instanceof Object){r={};for(let n in e){let s=e[n];N(s)?r[n]=j(s,t):r[n]=s}}return r};let A=(e,t,r,n,s="update",i)=>{if(!e._canEmitWatch)return;if("uphost"!==s&&r===n)return;if("update"==s&&N(r)&&N(n)&&r.stringify()===n.stringify())return;let l=e._watch[t];l&&l.forEach(e=>{let t={oldVal:n,type:s};t.uphost=a({},i),e(r,t)}),e._obs.forEach(l=>{let o={target:e,type:s,key:t,val:r,oldVal:n};o.uphost=a({},i),l(o)});let{_host:o}=e;if("uphost"!==s){let{_trend:i,_host:l,_hostkey:o}=e,h=[],d=t;for(;i;){h.unshift(d);let e={key:h,val:j(r),oldVal:j(n),type:s};if(i.forEach(t=>{t(a({},e))}),l){let t=l[o];A(l,o,t,t,"uphost",e),i=l._trend,d=o,l&&(o=l._hostkey),l=l._host}else i=null}}},P={set(e,t,r,n){if(/^_.+/.test(t))return Reflect.set(e,t,r,n);{let s,i=e[t],a=e.hasOwnProperty(t)?"update":"new";N(r)&&(s=r._id,r=r.toObject()),r=D(r,e._root||e,n,t,s);let l=!0;return e._exkeys?e._exkeys.indexOf(t)>-1?(e[t]=r,A(e,t,r,i,a)):l=Reflect.set(e,t,r,n):(l=Reflect.set(e,t,r,n),A(e,t,r,i,a)),l}},deleteProperty(e,t){if(/^_.+/.test(t))return Reflect.deleteProperty(e,t);{let r=e[t],n=Reflect.deleteProperty(e,t);return A(e,t,void 0,r,"delete"),n}}};const L=(e,t)=>{let r,n,s=t.key.length-1;return t.key.forEach((t,i)=>{e instanceof Object&&i<=s&&(i==s&&(r=e,n=t),e=e[t])}),[r,n]},S=(e,t,r="_id")=>{let n=[];if(N(e)){t&&e[r]==t?n.push(e):!t&&e.hasOwnProperty(r)&&n.push(e);let s=C(e,t,r);n.splice(0,0,...s)}return n},C=(e,n,s="_id")=>{let i=[];if(e instanceof t)if("_id"==s){for(let t in e)if(0 in(i=S(e[t],n,s)))break}else for(let t in e){let r=S(e[t],n,s);i.splice(i.length,0,...r)}else e instanceof r&&("_id"==s?e.some(e=>{if(0 in(i=S(e,n,s)))return!0}):e.forEach(e=>{let t=S(e,n,s);i.splice(i.length,0,...t)}));return i};let T={watch(e,t){switch(p(e)){case"string":let r=this._watch[e]||(this._watch[e]=[]);t&&r.push(t);break;case"object":for(let t in e)this.watch(t,e[t])}return this},unwatch(e,t){switch(p(e)){case"string":let r=this._watch[e]||(this._watch[e]=[]),n=r.indexOf(t);n>-1&&r.splice(n,1);break;case"object":for(let t in e)this.watch(t,e[t])}return this},observe(e){return e&&this._obs.push(e),this},unobserve(e){let t=this._obs.indexOf(e);return t>-1&&this._obs.splice(t,1),this},reset(e,t){if(t){if(t.watch)for(let e in this._watch)delete this._watch[e];t.obs&&(this._obs.length=0),t.trend&&(this._trend.length=0),sync&&(this._syncs.length=0)}for(let e in this)delete this[e];a(this,e)},trend(e){return e&&this._trend.push(e),this},entrend(e){let[t,r]=L(this,e);switch(e.type){case"delete":delete t[r];break;default:t[r]=e.val}return this},untrend(e){let t=this._trend.indexOf(e);return t>-1&&this._trend.splice(t,1),this},sync(e,t){return((e,t,r)=>{let n,s,i=p(r);switch(i){case"string":n=(e=>{let n=e.key[0];r===n&&t.entrend(e)}),s=(t=>{let n=t.key[0];r===n&&e.entrend(t)});break;case"array":n=(e=>{let n=e.key[0];r.indexOf(n)>-1&&t.entrend(e)}),s=(t=>{let n=t.key[0];r.indexOf(n)>-1&&e.entrend(t)});break;case"object":let a=Object.keys(r),l=Object.values(r);n=(e=>{let r=e.key[0];a.indexOf(r)>-1&&((e=JSON.parse(JSON.stringify(e))).key[0]=l[a.indexOf(r)],t.entrend(e))}),s=(t=>{let r=t.key[0];l.indexOf(r)>-1&&((t=JSON.parse(JSON.stringify(t))).key[0]=a[l.indexOf(r)],e.entrend(t))});break;default:n=(e=>t.entrend(e)),s=(t=>e.entrend(t))}e.trend(n),t.trend(s);let a=v();e._syncs.push({bid:a,type:i,func:n,opp:t}),t._syncs.push({bid:a,type:i,func:s,opp:e})})(this,e,t),this},unsync(e,t){return((e,t,r)=>{let n=p(r),s=e._syncs.find(e=>e.opp===t&&e.type===n);if(s){let{bid:r}=s,n=e._syncs.find(e=>e.bid==r),i=t._syncs.find(e=>e.bid==r);e._syncs.splice(n,1);let a=t._syncs.splice(i,1);a=a[0],e.untrend(s.func),t.untrend(a.func)}})(this,e,t),this},transData(e){let t={key:"",target:"",targetKey:""};a(t,e);let{key:r,target:n,targetKey:s,trans:i}=t;if(t.trans){let e={};for(let t in i)e[i[t]]=t;this.watch(r,e=>{e=i[e],n[s]=e}),n.watch(s,t=>{t=e[t],this[r]=t})}},toObject(){return j(this)},stringify(){let e=j(this);return JSON.stringify(e)},seek(e){let t,r=e.match(/\[.+?\]/g);if(r){let e=(e,r)=>{if(0===e)t=r;else{let e=[];r.forEach(r=>{t.indexOf(r)>-1&&e.push(r)}),t=e}};r.forEach((t,r)=>{if(t.search("=")>-1){let n=t.match(/\[(.+?)=(.+?)\]/),s=n[1],i=n[2],a=S(this,i,s);e(r,a)}else{let n=t.replace("[","").replace("]","").replace("=",""),s=S(this,void 0,n);e(r,s)}}),e=null}else t=S(this,e)[0];return t}};for(let e in T)o(t.prototype,e,{value:T[e]});let $=Object.create(Array.prototype);for(let e in T)o($,e,{value:T[e]});r.prototype=$;let D=(e,n,s,i,a)=>{let l=e,h=p(e);switch(h){case"object":l=((e,r,n,s,i)=>{let a=new t(r,n,s,i),l=new Proxy(a,P);for(let t in e){let{get:r,set:n}=Object.getOwnPropertyDescriptor(e,t);r||n?o(l,t,{get:r,set:n}):l[t]=e[t]}return a._canEmitWatch=1,l})(e,n,s,i,a);break;case"array":l=((e,t,n,s,i)=>{let a=new r(t,n,s,i),l=new Proxy(a,P);return Array.prototype.splice.call(l,0,0,...e),a._canEmitWatch=1,l})(e,n,s,i,a)}return N(e)||"object"!=h&&"array"!=h||(e._id=l._id),l};k.xdata=(e=>D(e)),k.detrend=L;let R=Object.create(_);R.svRender=!0;for(let e in T)o(R,e,{value:T[e]});o(R,"set",{value(e,t){-1===this._exkeys.indexOf(e)&&this._exkeys.push(e),this[e]=t}});const U=e=>{let r={tag:"",temp:"",attrs:[],props:[],data:{},watch:{}};a(r,e);let{proto:s,props:h,temp:d,tag:c}=r;h.push("value");let u=function(...e){t.apply(this,e)},p=R;if(s){p=l(R);for(let e in s){let{get:t,set:r}=Object.getOwnPropertyDescriptor(s,e);t||r?o(p,e,{set:r,get:t}):p[e]=s[e]}}u.prototype=p;var f=(d=d.replace(/<!--.+?-->/g,"")).match(/{{.+?}}/g);f&&f.forEach(e=>{var t=/{{(.+?)}}/.exec(e);t&&(d=d.replace(e,`<xv-span svkey="${t[1].trim()}"></xv-span>`))}),i[c]=a({},r,{XHear:u,temp:d}),n(r.tag+"[xv-ele]").each((e,t)=>{E(t)})};k.register=U;const H=(e,t)=>{let r=0,s=[],{prevObject:i}=e;return t?e.each((e,n)=>{c(n,"xv-shadow")&&n.getAttribute("xv-shadow")==t&&(s.push(n),r=1)}):e.each((e,t)=>{c(t,"xv-shadow")?r=1:s.push(t)}),r&&(e=n(s),i&&(e.prevObject=i)),e},M=(e,t)=>{let r=e[0].tagName.toLowerCase(),n=i[r],s=new Set([...Object.keys(n.data),...n.props,...n.attrs]);f(s,r=>{e[r]=t[r]})},q=e=>{let t=e.attr("xv-render");t&&(e.find(`[xv-shadow="${t}"]:not([xv-content])`).remove(),e.find(`[xv-shadow="${t}"][xv-content]`).each((e,t)=>{n(t).before(t.childNodes).remove()}));e.find("[xv-render]").each((e,t)=>{q(n(t))})},I=(e,t)=>{let r=p(t);if(e.is("[xv-shadow]")){let s=e.attr("xv-shadow");if("string"==r&&t.search("<")>-1){let e=n(t);e.attr("xv-shadow",s),e.find("*").attr("xv-shadow",s),t="",f(e,e=>{t+=e.outerHTML})}else r instanceof Element?n(t).attr("xv-shadow",s):t instanceof k&&n(Array.from(t)).attr("xv-shadow",s)}return t},B=e=>(e.is("[xv-render]")&&(e=e.map((e,t)=>{let r=t,n=t[m];for(;n&&n.$content;)n=(r=n.$content[0]).xvData;return r})),e);a(_,{add(...t){let r=t[0];if(r instanceof e.$&&r.is("xv-shadow"))throw"shadow element can't use add";return s.add.apply(this,t)},attr(...e){let[t,r]=e;return r&&this.is("[xv-render]")?(this.each((i,a)=>{let l=g(a);l&&l.attrs.indexOf(t)>-1?a[m][t]=r:s.attr.apply(n(a),e)}),this):s.attr.apply(this,e)},clone(...e){if(this.is("[xv-shadow]"))throw"shadow element can't use clone";if(this.svRender){let e=this.html(),t=n(`<div>${e}</div>`);t.find("[xv-render]").each((e,t)=>{n(t).removeAttr("xv-render").attr("xv-ele","")}),e=t.html();this[0].tagName.toLowerCase();let r=this[0].cloneNode();n(r).removeAttr("xv-render").attr("xv-ele","").html(e),E(r);let s=y(r);M(s,this);let i=n("[xv-render]:not([xv-shadow])",this);if(0 in i){let e=n("[xv-render]:not([xv-shadow])",s);e.length==i.length&&e.each((e,t)=>{let r=i[e];if(r.tagName!==t.tagName)return console.warn("cloned xv-ele data does not match"),!1;M(y(t),y(r))})}return s}{let t=this.is("[xv-render]"),r=0 in this.find("[xv-render]");if(t||r){let t=n(Array.from(this)),r=t.clone(...e);q(r),r.find("[xv-render]").removeAttr("xv-render").attr("xv-ele",""),w(r),t.each((e,t)=>{c(t,"xv-render")&&(r[e]=y(t).clone()[0])});let s=e=>{let n=r.find(e);if(0 in n){let r=t.find(e);n.length==r.length&&r.each((e,t)=>{M(y(n[e]),y(t))})}};return s("[xv-render]:not([xv-shadow])"),s("[xv-render][xv-shadow]"),this.prevObject&&(r.prevObject=this),b(r)}s.clone.apply(this,e)}},empty(){return s.empty.call(B(this)),this},parent(e){let t=this.map((e,t)=>{let r=t.parentNode;for(;r.svParent;)r=r.svParent;return r}),r=b(Array.from(new Set(t)));return e&&(r=r.filter(e)),r},parents(e){let t=[];this.each((e,r)=>{let n=r.parentNode;for(;n&&n!==document;){for(;n.svParent;)n=n.svParent;t.push(n),n=n.parentNode}});let r=b(Array.from(new Set(t)));return e&&(r=r.filter(e)),r},parentsUntil(e){let t=[];return this.each((r,s)=>{let i=s.parentNode;for(;i&&i!==document;){for(;i.svParent;)i=i.svParent;if(e&&n(i).is(e))break;t.push(i),i=i.parentNode}}),b(new Set(t))},unwrap(){let e=n(this).parent();return e.is("[xv-content]")?e.each((e,t)=>{let{svParent:r}=t;r=n(r?r:t);let s=t.childNodes;f(s,e=>{r.before(e)}),r.remove()}):s.unwrap.call(this),this},findReal(...e){return b(s.find.apply(this,e))},findShadow(...e){let t=s.find.apply(this,e);return t=H(t,this.attr("xv-render")),b(t)}}),f(["after","before","wrap","wrapAll","replaceWith"],e=>{let t=s[e];t&&(_[e]=function(e){return t.call(this,I(this,e)),w(this.parent()),this})}),f(["insertAfter","insertBefore","replaceAll"],e=>{let t=s[e];t&&(_[e]=function(r){if(this.is("[xv-shadow]"))throw"shadow element can't use "+e;return t.call(I(n(r),this),r),this})}),f(["append","prepend","wrapInner"],e=>{let t=s[e];t&&(_[e]=function(e){return t.call(B(this),I(this,e)),w(this),this})}),f(["appendTo","prependTo"],e=>{let t=s[e];t&&(_[e]=function(r){if(this.is("[xv-shadow]"))throw"shadow element can't use "+e;let s=n(r);return s.is("[xv-shadow]")&&I(s,this),t.call(this,B(s)),this})}),f(["find","children"],e=>{let t=s[e];t&&(_[e]=function(e){let r=t.call(B(this),e);return 1==r.length&&r[0][m]?r=y(r[0]):(r=this.is("[xv-shadow]")?H(r,this.attr("xv-shadow")):H(r),r=b(r)),r})}),f(["eq","first","last","filter","has","not","slice","next","nextAll","nextUntil","prev","prevAll","prevUntil","siblings"],e=>{s[e]&&(_[e]=function(...t){let r=s[e].apply(this,t);return r=b(r)})}),f(["html","text"],e=>{let t=s[e];t&&(_[e]=function(r){let s=this;if((e=>void 0===e)(r)){let e=n(s[0]);if(0 in e.find("[xv-shadow]")){let r=n(e[0].cloneNode(!0));return q(r),t.call(r)}return t.call(e)}return"text"!==e&&(r=I(this,r)),s=t.call(B(this),r),w(this),s})}),(()=>{let{pushStack:e}=s;e&&(_.pushStack=function(...t){return b(e.apply(this,t))})})();const W={register:U};e.xhear=W,e.$=k,n(()=>{const e=e=>{if(e[x])return;let t=g(e);t.attached&&t.attached.call(e,y(e)),e[x]=1},t=e=>{if(e.getRootNode()!=document){let t=g(e);t.detached&&t.detached.call(e,y(e)),n("[xv-content]",e).each((e,t)=>{delete t.svParent});let r=e[m];r&&(r.__obs&&r.__obs.disconnect(),delete r.__obs,delete e[m])}};new MutationObserver(r=>{r.forEach(r=>{let{addedNodes:s,removedNodes:i}=r;s&&0 in s&&f(s,t=>{t[m]&&e(t),t instanceof Element&&f(t.querySelectorAll("[xv-render]"),t=>{e(t)})}),i&&0 in i&&f(i,e=>{e[m]&&t(e),n("[xv-render]",e).each((e,r)=>{t(r)})})})}).observe(document.body,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),n("[xv-ele]").each((e,t)=>{E(t)})}),n("head").append("<style>[xv-ele]{display:none}</style>")})(window);