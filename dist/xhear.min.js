(e=>{"use strict";let t={};e.tagDatabase=t;const r=Object.assign,a=Object.create,s=Object.defineProperty;let n=e=>void 0!==e&&null!==e;const l=(e,t)=>{if(!e.getAttribute)return 0;let r=e.getAttribute(t);return null!==r&&void 0!==r?1:void 0};let o=Object.prototype.toString;const i=e=>o.call(e).toLowerCase().replace(/(\[object )|(])/g,""),h=(e,t)=>Array.from(e).forEach(t),d=((()=>{let e=!1,t=[]})(),"_"+Math.random().toString(32).substr(2)),c=d+"_watchs",v=d+"_watchs_ori",u="_svkey"+d;let f=e.$,p=f.fn,w=a(p);const m=e=>{let t=e._svData,r=a(t);return r.push(e),r},g=p.splice?e=>{let t=a(w);return t.splice(-1,0,...e),e.prevObject&&(t.prevObject=e.prevObject),t}:e=>{let t=a(w);for(let r=e.length,a=0;a<r;a++)t.push(e[a]);return e.prevObject&&(t.prevObject=e.prevObject),t},b=e=>1==e.length&&e[0]._svData?m(e[0]):g(e),y=e=>{e.each((e,t)=>{l(t,"sv-ele")&&P(t)}),f("[sv-ele]",Array.from(e)).each((e,t)=>{P(t)})},_=(e,t)=>{let r=0,a=[],{prevObject:s}=e;return t?e.each((e,s)=>{l(s,"sv-shadow")&&s.getAttribute("sv-shadow")==t&&(a.push(s),r=1)}):e.each((e,t)=>{l(t,"sv-shadow")?r=1:a.push(t)}),r&&(e=f(a),s&&(e.prevObject=s)),e},A=e=>{let r=e.tagName.toLowerCase();return t[r]},N=(e,t,r=c)=>e[r][t]||(e[r][t]=[]),O=(e,t,r,a,s)=>{let n=N(e,t),l=N(e,t,v);n.concat(l).forEach(e=>{e(r,a,s)})};let j=r(a(w),{set(e,t){if("object"==i(e)){if(!t)for(let t in e)this.set(t,e[t]);return}let r=this;if(0 in r&&r[0]._svData&&(r=r[0]._svData),e in r)return void console.warn("the value exists => ",e);let a;s(r,e,{enumerable:!0,get:()=>a,set:t=>(O(r,e,t,a,t),a=t,t)}),r[e]=t},watch(e,t){if("string"==i(e)){N(this,e).push(t)}else for(let t in e)this.watch(t,e[t])},unwatch(e,t){if(e){let r=N(this,e);if(t){let e=r.indexOf(t);r.splice(e,1)}else r.length=0}},findReal(...e){return b(p.find.apply(this,e))},findShadow(...e){let t=p.find.apply(this,e);return t=_(t,this.attr("sv-render")),b(t)},svRender:!0});const D=(e,t,r)=>{N(e,t,v).push(r)},x=(e,t,r)=>{let a=e[t];switch(t){case"val":r.val(a);break;default:r[t]=a}},S=(e,t,r,a,s=(()=>{}))=>{let n,l=()=>void 0;"function"==i(e)?l=e:(l=e.get,n=e.set);let o={enumerable:!0,get:()=>l.call(r)};return n&&(o.set=(e=>{let o="val"==t?r.val():r[t],i=n.call(r,e),h=e;return l&&"val"!==t&&(h=a[t]),O(a,t,h,o,e),s(h),i})),o};let k=100;const P=e=>{if(l(e,"sv-ele")){let t=A(e);if(!t)return void console.warn("this element is not defined",e);let a=f(e),l=Array.from(e.childNodes);e.innerHTML=t.code;let o=++k;a.removeAttr("sv-ele").attr("sv-render",o),a.find("*").attr("sv-shadow",o),f(`[sv-ele][sv-shadow="${o}"]`,e).each((e,t)=>{P(t)});let i=new t.Shear;e._svData=i,f(`sv-span[sv-shadow="${o}"]`,e).each((e,t)=>{var r=document.createTextNode("");t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t);var a=t.getAttribute(u);D(i,a,e=>{r.textContent=e})});let d=f(`[sv-content][sv-shadow="${o}"]`,e);if(delete d.prevObject,d[0]&&(s(i,"$content",{enumerable:!0,get:()=>b(d)}),d.append(l),d.prop("svParent",e),t.childChange)){let r=new MutationObserver(r=>{r.forEach(r=>{let{addedNodes:a,removedNodes:s}=r,n={};0 in a&&(n.addedNodes=Array.from(a)),0 in s&&(n.removedNodes=Array.from(s)),t.childChange(m(e),n)})});r.observe(d[0],{attributes:!1,childList:!0,characterData:!1,subtree:!1}),i.__obs=r}f(`[sv-tar][sv-shadow="${o}"]`,e).each((e,t)=>{let r=f(t).attr("sv-tar");s(i,"$"+r,{enumerable:!0,get:()=>b([t])})});let c=m(e),v=t.pri;if(v)for(let e in v)c["_"+e]=v[e];let p={};r(p,t.data),t.attrs.forEach(e=>{let t=a.attr(e);n(t)&&(p[e]=t),D(i,e,t=>{a.attr(e,t)})}),t.props.forEach(e=>{let t=a.attr(e);n(t)&&(p[e]=t)}),f(`[sv-module][sv-shadow="${o}"]`,e).each((e,t)=>{let r=f(t),s=r.attr("sv-module");D(i,s,e=>{t.value=e}),r.on("input change",e=>{"val"==s?a.val(t.value):i[s]=t.value}),"select"==t.tagName.toLowerCase()&&(p[s]=t.value)});let w=t.val;if(0 in f(`[sv-module="val"][sv-shadow="${o}"]`,e)&&!w){let e="";w={get:()=>e,set:t=>e=t}}if(w){let t=S(w,"val",c,i);s(e,"value",t)}a.on("change input",t=>{t.target!==e&&t.stopImmediatePropagation()});let g=r({},t.computed),y=Object.keys(g);for(let e in p)if(!g[e]&&"val"!==e){let t;g[e]={get:()=>t,set(e){t=e}}}for(let e in g){let t=S(g[e],e,c,i);s(i,e,t)}t.render&&t.render(c,p);for(let e in p)y.indexOf(e)>-1||x(p,e,c);h(y,e=>{n(p[e])&&x(p,e,c)}),t.inited&&t.inited(c),e.getRootNode()===document&&t.attached&&!e._u_attached&&(t.attached(c),e._u_attached=1)}},C={register:e=>{function n(e={}){s(this,c,{value:{}}),s(this,v,{value:{}})}let l={tag:"",temp:"<div sv-content></div>",attrs:[],props:[],data:{},proto:{},pri:{}};r(l,e),l.props.push("val"),n.prototype=r(a(j),l.proto);let o=l.temp;var i=(o=o.replace(/<!--.+?-->/g,"")).match(/{{.+?}}/g);i&&i.forEach(e=>{var t=/{{(.+?)}}/.exec(e);t&&(o=o.replace(e,`<sv-span ${u}="${t[1].trim()}"></sv-span>`))}),t[l.tag]=r({Shear:n,code:o},l),f(l.tag+"[sv-ele]").each((e,t)=>{P(t)})}};e.xhear=C,e.$=function(...e){let t=f(...e),[r,a]=e;("string"==i(r)&&r.search("<")>-1||r instanceof Element)&&y(t);let s;return a&&(a.getAttribute?s=a.getAttribute("sv-shadow"):a.attr&&(s=a.attr("sv-shadow"))),t=s?_(t,s):_(t),t=b(t)},r($,f),r($,{init:e=>b([e])}),$.prototype=$.fn=p;const E=(e,r)=>{let a=e[0].tagName.toLowerCase(),s=t[a],n=new Set([...Object.keys(s.data),...s.props,...s.attrs]);h(n,t=>{e[t]=r[t]})},L=e=>{let t=e.attr("sv-render");t&&(e.find(`[sv-shadow="${t}"]:not([sv-content])`).remove(),e.find(`[sv-shadow="${t}"][sv-content]`).each((e,t)=>{f(t).before(t.childNodes).remove()}));e.find("[sv-render]").each((e,t)=>{L(f(t))})},M=(e,t)=>{let r=i(t);if(e.is("[sv-shadow]")){let a=e.attr("sv-shadow");if("string"==r&&t.search("<")>-1){let e=f(t);e.attr("sv-shadow",a),e.find("*").attr("sv-shadow",a),t="",h(e,e=>{t+=e.outerHTML})}else r instanceof Element?f(t).attr("sv-shadow",a):t instanceof $&&f(Array.from(t)).attr("sv-shadow",a)}return t},R=e=>(e.is("[sv-render]")&&(e=e.map((e,t)=>{let r=t,{_svData:a}=t;for(;a&&a.$content;)a=(r=a.$content[0])._svData;return r})),e);r(w,{add(...t){let r=t[0];if(r instanceof e.$&&r.is("sv-shadow"))throw"shadow element can't use add";return p.add.apply(this,t)},attr(...e){let[r,a]=e;if(!a||!this.is("[sv-render]"))return p.attr.apply(this,e);this.each((s,n)=>{let l=n.tagName.toLowerCase(),o=t[l];o&&o.attrs.indexOf(r)>-1?n._svData[r]=a:p.attr.apply(f(n),e)})},clone(...e){if(this.is("[sv-shadow]"))throw"shadow element can't use clone";if(this.svRender){let e=this.html(),t=f(`<div>${e}</div>`);t.find("[sv-render]").each((e,t)=>{f(t).removeAttr("sv-render").attr("sv-ele","")}),e=t.html();this[0].tagName.toLowerCase();let r=this[0].cloneNode();f(r).removeAttr("sv-render").attr("sv-ele","").html(e),P(r);let a=m(r);E(a,this);let s=f("[sv-render]:not([sv-shadow])",this);if(0 in s){let e=f("[sv-render]:not([sv-shadow])",a);e.length==s.length&&e.each((e,t)=>{let r=s[e];if(r.tagName!==t.tagName)return console.warn("cloned sv-ele data does not match"),!1;E(m(t),m(r))})}return a}{let t=this.is("[sv-render]"),r=0 in this.find("[sv-render]");if(t||r){let t=f(Array.from(this)),r=t.clone(...e);L(r),r.find("[sv-render]").removeAttr("sv-render").attr("sv-ele",""),y(r),t.each((e,t)=>{l(t,"sv-render")&&(r[e]=m(t).clone()[0])});let a=e=>{let a=r.find(e);if(0 in a){let r=t.find(e);a.length==r.length&&r.each((e,t)=>{E(m(a[e]),m(t))})}};return a("[sv-render]:not([sv-shadow])"),a("[sv-render][sv-shadow]"),this.prevObject&&(r.prevObject=this),b(r)}p.clone.apply(this,e)}},empty(){return p.empty.call(R(this)),this},parent(e){let t=this.map((e,t)=>{let r=t.parentNode;for(;r.svParent;)r=r.svParent;return r}),r=b(Array.from(new Set(t)));return e&&(r=r.filter(e)),r},parents(e){let t=[];this.each((e,r)=>{let a=r.parentNode;for(;a&&a!==document;){for(;a.svParent;)a=a.svParent;t.push(a),a=a.parentNode}});let r=b(Array.from(new Set(t)));return e&&(r=r.filter(e)),r},parentsUntil(e){let t=[];return this.each((r,a)=>{let s=a.parentNode;for(;s&&s!==document;){for(;s.svParent;)s=s.svParent;if(e&&f(s).is(e))break;t.push(s),s=s.parentNode}}),b(new Set(t))},unwrap(){let e=f(this).parent();return e.is("[sv-content]")?e.each((e,t)=>{let{svParent:r}=t;r=f(r?r:t);let a=t.childNodes;h(a,e=>{r.before(e)}),r.remove()}):p.unwrap.call(this),this}}),h(["after","before","wrap","wrapAll","replaceWith"],e=>{let t=p[e];t&&(w[e]=function(e){return t.call(this,M(this,e)),y(this.parent()),this})}),h(["insertAfter","insertBefore","replaceAll"],e=>{let t=p[e];t&&(w[e]=function(r){if(this.is("[sv-shadow]"))throw"shadow element can't use "+e;return t.call(M(f(r),this),r),this})}),h(["append","prepend","wrapInner"],e=>{let t=p[e];t&&(w[e]=function(e){return t.call(R(this),M(this,e)),y(this),this})}),h(["appendTo","prependTo"],e=>{let t=p[e];t&&(w[e]=function(r){if(this.is("[sv-shadow]"))throw"shadow element can't use "+e;let a=f(r);return a.is("[sv-shadow]")&&M(a,this),t.call(this,R(a)),this})}),h(["find","children"],e=>{let t=p[e];t&&(w[e]=function(e){let r=t.call(R(this),e);return 1==r.length&&r[0]._svData?r=m(r[0]):(r=this.is("[sv-shadow]")?_(r,this.attr("sv-shadow")):_(r),r=b(r)),r})}),h(["eq","first","last","filter","has","not","slice","next","nextAll","nextUntil","prev","prevAll","prevUntil","siblings"],e=>{p[e]&&(w[e]=function(...t){let r=p[e].apply(this,t);return r=b(r)})}),h(["html","text"],e=>{let t=p[e];t&&(w[e]=function(r){let a=this;if((e=>void 0===e)(r)){let e=f(a[0]);if(0 in e.find("[sv-shadow]")){let r=f(e[0].cloneNode(!0));return L(r),t.call(r)}return t.call(e)}return"text"!==e&&(r=M(this,r)),a=t.call(R(this),r),y(this),a})}),(()=>{let{pushStack:e}=p;e&&(w.pushStack=function(...t){return b(e.apply(this,t))})})();const T=$.bridge=((...e)=>{let t;h(e,(r,a)=>{let{tar:s,key:n}=r;r instanceof $&&(s=r,n="val"),s.watch(n,(r,a,n)=>{t!==n&&(t=n,h(e,e=>{let t,r;e instanceof $?(t=e,r="val"):(t=e.tar,r=e.key),s!==t&&("val"===r?t.val(n):t[r]=n)}))}),a==e.length-1&&("val"===n?s.val(s.val()):s[n]=s[n])})});$.syncData=((...e)=>{let t=[];h(e,r=>{if(r instanceof q)for(let a in r){if(t.indexOf(a)>-1)continue;let s=[{tar:r,key:a}];h(e,e=>{e!==r&&a in e&&s.push({tar:e,key:a})}),1 in s&&T(...s),t.push(a)}})});let U={},q=$.XData=function(e){s(this,c,{value:{}}),s(this,v,{value:{}}),this.set(e)};h(["watch","unwatch","set"],e=>{s(U,e,{value:j[e]})}),s(U,"cover",{value(e){for(let t in e)this[t]=e[t]}}),q.prototype=U,f(()=>{f("[sv-ele]").each((e,t)=>{P(t)});const e=e=>{if(e._u_attached)return;let t=A(e);t.attached&&t.attached(m(e)),e._u_attached=1},t=e=>{if(e.getRootNode()!=document){let t=A(e);t.detached&&t.detached(m(e)),f("[sv-content]",e).each((e,t)=>{delete t.svParent});let{_svData:r}=e;r&&(r.__obs&&r.__obs.disconnect(),delete r.__obs,delete e._svData)}};new MutationObserver(r=>{r.forEach(r=>{let{addedNodes:a,removedNodes:s}=r;a&&0 in a&&h(Array.from(a),t=>{t._svData&&e(t),t instanceof Element&&h(Array.from(t.querySelectorAll("[sv-render]")),t=>{e(t)})}),s&&0 in s&&h(Array.from(s),e=>{e._svData&&t(e),f("[sv-render]",e).each((e,r)=>{t(r)})})})}).observe(document.body,{attributes:!1,childList:!0,characterData:!1,subtree:!0})}),f("head").append("<style>[sv-ele]{display:none}</style>")})(window);