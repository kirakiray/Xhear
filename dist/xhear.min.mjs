//! xhear - v7.2.10 https://github.com/kirakiray/Xhear  (c) 2018-2023 YAO
const getRandomId=()=>Math.random().toString(32).slice(2),objectToString=Object.prototype.toString,getType=e=>objectToString.call(e).toLowerCase().replace(/(\[object )|(])/g,""),isObject=e=>{const t=getType(e);return"array"===t||"object"===t},tickSets=new Set;function nextTick(e){const t=`t-${getRandomId()}`;return tickSets.add(t),Promise.resolve().then((()=>{tickSets.has(t)&&(e(),tickSets.delete(t))})),t}function debounce(e,t=0){let r=null,n=[];return function(...a){n.push(...a),t>0?(clearTimeout(r),r=setTimeout((()=>{e.call(this,n),n=[],r=null}),t)):null===r&&(r=1,nextTick((()=>{e.call(this,n),n=[],r=null})))}}const extend=(e,t,r={})=>([...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)].forEach((n=>{const a=Object.getOwnPropertyDescriptor(t,n),{configurable:s,enumerable:o,writable:i,get:l,set:c,value:h}=a;"value"in a?e.hasOwnProperty(n)?e[n]=h:Object.defineProperty(e,n,{enumerable:o,configurable:s,writable:i,...r,value:h}):Object.defineProperty(e,n,{enumerable:o,configurable:s,...r,get:l,set:c})})),e),isFunction=e=>getType(e).includes("function"),hyphenToUpperCase=e=>e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}const isArrayEqual=(e,t)=>{if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0},toDashCase=e=>e.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})),meetsEle=(e,t)=>{const r=document.createElement("template");return r.content.append(e.cloneNode()),!!r.content.querySelector(t)};function isEmptyObject(e){if(!e)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function moveArrayValue(e,t,r){const n=e.indexOf(t);if(-1===n)throw new Error("Value not found in array");return e.splice(r,0,e.splice(n,1)[0]),e}const removeArrayValue=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},searchEle=(e,t)=>Array.from(e.querySelectorAll(t)),{assign:assign$1,freeze:freeze}=Object;class Watcher{constructor(e){assign$1(this,e),freeze(this)}_getCurrent(e){let{currentTarget:t}=this;if(/\./.test(e)){const r=e.split(".");e=r.pop(),t=t.get(r.join("."))}return{current:t,key:e}}hasModified(e){if("array"===this.type)return this.path.includes(this.currentTarget.get(e));if(/\./.test(e)){const{current:t,key:r}=this._getCurrent(e);return t===this.path.slice(-1)[0]?this.name===r:this.path.includes(t)}return this.path.length?this.path.includes(this.currentTarget[e]):this.name===e}hasReplaced(e){if("set"!==this.type)return!1;if(/\./.test(e)){const{current:t,key:r}=this._getCurrent(e);return t===this.path.slice(-1)[0]&&this.name===r}return!this.path.length&&this.name===e}}class Watchers extends Array{constructor(e){super(...e)}hasModified(e){return this.some((t=>t.hasModified(e)))}hasReplaced(e){return this.some((t=>t.hasReplaced(e)))}}const emitUpdate=({type:e,currentTarget:t,target:r,name:n,value:a,oldValue:s,args:o,path:i=[]})=>{if(i&&i.includes(t))return void console.warn("Circular references appear");let l={type:e,target:r,name:n,oldValue:s,value:a};if("array"===e&&(delete l.value,l.args=o),t._hasWatchs){const e=new Watcher({currentTarget:t,...l,path:[...i]});t[WATCHS].forEach((t=>{t(e)}))}t._update&&t.owner.forEach((e=>{emitUpdate({currentTarget:e,...l,path:[t,...i]})}))};var watchFn={watch(e){const t="w-"+getRandomId();return this[WATCHS].set(t,e),t},unwatch(e){return this[WATCHS].delete(e)},watchTick(e,t){return this.watch(debounce((t=>{try{this.xid}catch(e){return}t=t.filter((e=>{try{e.path.forEach((e=>e.xid))}catch(e){return!1}return!0})),e(new Watchers(t))}),t||0))}};const mutatingMethods$1=["push","pop","shift","unshift","splice","reverse","sort","fill","copyWithin"],holder=Symbol("placeholder");function compareArrays(e,t){const r=Array.from(t),n=Array.from(e),a=[],s=new Map,o=e.length;for(let t=0;t<o;t++){const n=e[t],s=r.indexOf(n);s>-1?r[s]=holder:a.push(n)}const i=t.length;for(let e=0;e<i;e++){const r=t[e],a=n.indexOf(r);a>-1?n[a]=holder:s.set(e,r)}return{deletedItems:a,addedItems:s}}const fn$1={},arrayFn$1=Array.prototype;mutatingMethods$1.forEach((e=>{arrayFn$1[e]&&(fn$1[e]=function(...t){const r=Array.from(this),n=arrayFn$1[e].apply(this[SELF],t),{deletedItems:a,addedItems:s}=compareArrays(r,this);for(let[e,t]of s)isxdata(t)?t._owner.push(this):isObject(t)&&(this.__unupdate=1,this[e]=t,delete this.__unupdate);for(let e of a)clearData(e,this);return emitUpdate({type:"array",currentTarget:this,target:this,args:t,name:e,oldValue:r}),n===this[SELF]?this[PROXY]:n})}));const{defineProperties:defineProperties$2,getOwnPropertyDescriptor:getOwnPropertyDescriptor,entries:entries}=Object,SELF=Symbol("self"),PROXY=Symbol("proxy"),WATCHS=Symbol("watchs"),ISXDATA=Symbol("isxdata"),isxdata=e=>e&&!!e[ISXDATA];function constructor(e,t=handler$1){let r,{proxy:n,revoke:a}=Proxy.revocable(this,t);return n._update=1,defineProperties$2(this,{xid:{value:e.xid||getRandomId()},_owner:{value:[]},owner:{configurable:!0,get(){return new Set(this._owner)}},[ISXDATA]:{value:!0},[SELF]:{configurable:!0,get:()=>this},[PROXY]:{configurable:!0,get:()=>n},[WATCHS]:{get:()=>r||(r=new Map)},_hasWatchs:{get:()=>!!r},_revoke:{value:a}}),Object.keys(e).forEach((t=>{const r=getOwnPropertyDescriptor(e,t);let{value:a,get:s,set:o}=r;s||o?defineProperties$2(this,{[t]:r}):n[t]=a})),n}class Stanz extends Array{constructor(e){return super(),constructor.call(this,e)}revoke(){const e=this[SELF];e._onrevokes&&(e._onrevokes.forEach((e=>e())),e._onrevokes.length=0),e.__unupdate=1,e[WATCHS].clear(),entries(this).forEach((([e,t])=>{isxdata(t)&&(this[e]=null)})),e._owner.forEach((e=>{entries(e).forEach((([t,r])=>{r===this&&(e[t]=null)}))})),delete e[SELF],delete e[PROXY],e._revoke()}toJSON(){let e={},t=!0,r=0;Object.keys(this).forEach((n=>{let a=this[n];/\D/.test(n)?t=!1:(n=parseInt(n))>r&&(r=n),isxdata(a)&&(a=a.toJSON()),e[n]=a})),t&&(e.length=r+1,e=Array.from(e));const n=this.xid;return defineProperties$2(e,{xid:{get:()=>n}}),e}toString(){return JSON.stringify(this.toJSON())}extend(e,t){return extend(this,e,t)}get(e){if(/\./.test(e)){const t=e.split(".");let r=this;for(let e=0,n=t.length;e<n;e++)try{r=r[t[e]]}catch(n){const a=new Error(`Failed to get data : ${t.slice(0,e).join(".")} \n${n.stack}`);throw Object.assign(a,{error:n,target:r}),a}return r}return this[e]}set(e,t){if(/\./.test(e)){const r=e.split("."),n=r.pop();let a=this;for(let e=0,t=r.length;e<t;e++)try{a=a[r[e]]}catch(t){const n=new Error(`Failed to get data : ${r.slice(0,e).join(".")} \n${t.stack}`);throw Object.assign(n,{error:t,target:a}),n}return a[n]=t}return this[e]=t}}Stanz.prototype.extend({...watchFn,...fn$1},{enumerable:!1});const{defineProperties:defineProperties$1}=Object,setData=({target:e,key:t,value:r,receiver:n,type:a,succeed:s})=>{let o=r;isxdata(o)?o._owner.push(n):isObject(r)&&(o=new Stanz(r),o._owner.push(n));const i=n[t],l=i===r;!l&&isxdata(i)&&clearData(i,n);const c=s(o);return!l&&!e.__unupdate&&emitUpdate({type:a||"set",target:n,currentTarget:n,name:t,value:r,oldValue:i}),c},clearData=(e,t)=>{if(isxdata(e)){const r=e._owner.indexOf(t);r>-1?e._owner.splice(r,1):console.error({desc:"This data is wrong, the owner has no boarding object at the time of deletion",target:t,mismatch:e})}},handler$1={set(e,t,r,n){if("symbol"==typeof t)return Reflect.set(e,t,r,n);if(/^_/.test(t))return e.hasOwnProperty(t)?Reflect.set(e,t,r,n):defineProperties$1(e,{[t]:{writable:!0,configurable:!0,value:r}}),!0;try{return setData({target:e,key:t,value:r,receiver:n,succeed:r=>Reflect.set(e,t,r,n)})}catch(e){const a=new Error(`failed to set ${t} \n ${e.stack}`);throw Object.assign(a,{key:t,value:r,target:n,error:e}),a}},deleteProperty:(e,t)=>/^_/.test(t)||"symbol"==typeof t?Reflect.deleteProperty(e,t):setData({target:e,key:t,value:void 0,receiver:e[PROXY],type:"delete",succeed:()=>Reflect.deleteProperty(e,t)})},handler={set:(e,t,r,n)=>/\D/.test(t)?handler$1.set(e,t,r,n):Reflect.set(e,t,r,n),get:(e,t,r,n)=>/\D/.test(String(t))?Reflect.get(e,t,r,n):eleX(e.ele.children[t]),ownKeys(e){let t=Reflect.ownKeys(e),r=e.ele.children.length;for(let e=0;e<r;e++)t.push(String(e));return t},getOwnPropertyDescriptor:(e,t)=>"string"!=typeof t||/\D/.test(t)?Reflect.getOwnPropertyDescriptor(e,t):{enumerable:!0,configurable:!0}},getRevokes=e=>e.__revokes||(e.__revokes=[]),addRevoke=(e,t)=>getRevokes(e).push(t),convertToFunc=(e,t)=>new Function("...$args",`\nconst [$event] = $args;\ntry{\n  with(this){\n    return ${e};\n  }\n}catch(error){\n  console.error(error);\n}\n`).bind(t);function render({data:e,target:t,template:r,temps:n,isRenderSelf:a,...s}){const o=r&&r.innerHTML;o&&(t.innerHTML=o);const i=searchEle(t,"xtext"),l=[],c=getRevokes(t);i.forEach((t=>{const r=document.createTextNode(""),{parentNode:n}=t;n.insertBefore(r,t),n.removeChild(t);const a=convertToFunc(t.getAttribute("expr"),e),s=()=>{r.textContent=a()};l.push(s);const o=()=>{removeArrayValue(c,o),removeArrayValue(l,s),removeArrayValue(getRevokes(r),o)};c.push(o),addRevoke(r,o)}));const h=searchEle(t,"[x-bind-data]");if(a&&meetsEle(t,"[x-bind-data]")&&h.unshift(t),h.forEach((t=>{const r=JSON.parse(t.getAttribute("x-bind-data")),a=eleX(t);for(let[o,i]of Object.entries(r))i.forEach((r=>{try{const{always:i}=a[o],h=()=>a[o](...r,{isExpr:!0,data:e,temps:n,...s});let d;if(i)l.push(h),d=()=>{removeArrayValue(c,d),removeArrayValue(l,h),removeArrayValue(getRevokes(t),d)};else{const e=h();isFunction(e)?d=()=>{removeArrayValue(c,d),removeArrayValue(getRevokes(t),d),e()}:console.warn(`${o} render method need return revoke`)}c.push(d),addRevoke(t,d)}catch(e){const t=new Error(`Execution of the ${o} method reports an error :\n ${e.stack}`);throw t.error=e,t}}));t.removeAttribute("x-bind-data")})),t.__render_temps||isEmptyObject(n)||(t.__render_temps=n),l.length){if(t.__render_data&&t.__render_data!==e){const r=new Error("An old listener already exists and the rendering of this element may be wrong");throw Object.assign(r,{element:t,old:t.__render_data,new:e}),r}t.__render_data=e,l.forEach((e=>e()));const r=e.watchTick((t=>{l.length?l.forEach((e=>e())):e.unwatch(r)}))}}function convert(e){let t={};const{tagName:r}=e;if("TEMPLATE"===r){let r=e.innerHTML;const n=r.match(/{{.+?}}/g);n&&(n.forEach((e=>{r=r.replace(e,`<xtext expr="${e.replace(/{{(.+?)}}/,"$1")}"></xtext>`)})),e.innerHTML=r);const a=e.getAttribute("name");a&&(e.content.children.length>1&&console.warn({target:e,content:e.innerHTML,desc:"Only the first child element inside the template will be used"}),t[a]=e,e.remove()),t={...t,...convert(e.content)}}else if(r){const t={};Array.from(e.attributes).forEach((r=>{const n=/(.*):(.+)/.exec(r.name);if(!n)return;let[,a,s]=n;a||(a="prop");(t[a]||(t[a]=[])).push([s,r.value]),e.removeAttribute(r.name)}));Object.keys(t).length&&e.setAttribute("x-bind-data",JSON.stringify(t))}return e.children&&Array.from(e.children).forEach((e=>{t={...t,...convert(e)}})),t}const getVal=e=>isFunction(e)?e():e,defaultData={_convertExpr(e={},t){const{isExpr:r,data:n}=e;return r?convertToFunc(t,n):t},prop(...e){let[t,r,n]=e;if(1===e.length)return this[t];r=this._convertExpr(n,r),r=getVal(r),t=hyphenToUpperCase(t),this[t]=r},attr(...e){let[t,r,n]=e;if(1===e.length)return this.ele.getAttribute(t);r=this._convertExpr(n,r),r=getVal(r),this.ele.setAttribute(t,r)}};defaultData.prop.always=!0,defaultData.attr.always=!0;var syncFn={sync(e,t,r){if(!r)throw"Sync is only allowed within the renderer";const{data:n}=r;this[e]=n.get(t);const a=this.watch((r=>{r.hasModified(e)&&n.set(t,this.get(e))})),s=n.watch((r=>{r.hasModified(t)&&this.set(e,n.get(t))}));return()=>{this.unwatch(a),n.unwatch(s)}}},eventFn={on(e,t,r){return t=r&&r.isExpr&&!/[^\d\w_\$\.]/.test(t)?r.data.get(t):this._convertExpr(r,t),r&&r.data&&(t=t.bind(r.data)),this.ele.addEventListener(e,t),r?()=>this.ele.removeEventListener(e,t):this},one(e,t,r){const n=r=>{this.off(e,n),t(r)};return this.on(e,n,r),this},off(e,t){return this.ele.removeEventListener(e,t),this},emit(e,t,r){let n;return e instanceof Event?n=e:e&&(n=new Event(e,{bubbles:!0,...r})),t&&Object.assign(n,t),this.ele.dispatchEvent(n),this}};const originSplice=(e,t,r,...n)=>{const{children:a}=e,s=[];for(let e=t,n=t+r;e<n;e++){const t=a[e];s.push(t)}if(s.forEach((e=>e.remove())),n.length){const r=document.createDocumentFragment();n.forEach((e=>r.append(createXEle(e).ele)));const s=a[t];s?e.insertBefore(r,s):e.appendChild(r)}return s},mutatingMethods=["push","pop","shift","unshift","splice","reverse","sort","fill","copyWithin"],likeArrayFn={push(...e){const{ele:t}=this;return originSplice(t,t.children.length,0,...e),emitUpdate({type:"array",currentTarget:this,target:this,args:e,name:"push"}),t.children.length},pop(...e){const{ele:t}=this,r=originSplice(t,t.children.length-1,1,...e);return emitUpdate({type:"array",currentTarget:this,target:this,args:e,name:"pop"}),eleX(r[0])},shift(...e){const{ele:t}=this,r=originSplice(t,0,1,...e);return emitUpdate({type:"array",currentTarget:this,target:this,args:e,name:"shift"}),eleX(r[0])},unshift(...e){const{ele:t}=this;return originSplice(t,0,0,...e),emitUpdate({type:"array",currentTarget:this,target:this,args:e,name:"unshift"}),t.children.length},splice(...e){const t=originSplice(this.ele,...e);return emitUpdate({type:"array",currentTarget:this,target:this,args:e,name:"splice"}),t.map(eleX)},reverse(...e){const t=Array.from(this.ele.childNodes);arrayFn.reverse.call(t,...e);const r=document.createDocumentFragment();return t.forEach((e=>{e.__inArray=1,r.append(e)})),this.ele.append(r),t.forEach((e=>{delete e.__inArray})),emitUpdate({type:"array",currentTarget:this,target:this,args:e,name:"reverse"}),this},sort(...e){const t=Array.from(this.ele.children).map(eleX);arrayFn.sort.call(t,...e);const r=document.createDocumentFragment();return t.forEach((e=>{e.ele.__inArray=1,r.append(e.ele)})),this.ele.append(r),t.forEach((e=>{delete e.ele.__inArray})),emitUpdate({type:"array",currentTarget:this,target:this,args:e,name:"sort"}),this}},arrayFn=Array.prototype;Object.keys(Object.getOwnPropertyDescriptors(arrayFn)).forEach((e=>{if("constructor"===e||"length"===e||mutatingMethods.includes(e))return;const t=arrayFn[e];isFunction(t)&&(likeArrayFn[e]=function(...e){return t.apply(Array.from(this.ele.children).map(eleX),e)})}));class LikeArray{}for(let[e,t]of Object.entries(likeArrayFn))Object.defineProperty(LikeArray.prototype,e,{value:t});const stanz=e=>new Stanz(e);Object.assign(stanz,{is:isxdata});const{defineProperty:defineProperty,assign:assign}=Object,hasValueEleNames=["input","textarea","select"],setKeys=(e,t)=>{const{ele:r}=t;e.forEach((e=>{if(e in r){let n=!1;defineProperty(t,e,{enumerable:!0,get:()=>n?Number(r[e]):r[e],set:t=>{n="number"==typeof t,r[e]=t}})}}))},formEleNames=new Set([...hasValueEleNames,"option","button","label","fieldset","legend","form"]),bindProp=(e,t={})=>{const{name:r,type:n}=t,{ele:a}=e;let s=a[r];e.on(n,(()=>{emitUpdate({type:"set",target:e,currentTarget:e,name:r,value:a[r],oldValue:s}),s=a[r]}))},initFormEle=e=>{const{tag:t}=e;if(formEleNames.has(t))switch(setKeys(["type","name","disabled"],e),t){case"input":initInput(e);break;case"textarea":setKeys(["value"],e),bindProp(e,{name:"value",type:"input"});break;case"option":setKeys(["selected","value"],e);break;case"select":setKeys(["value"],e),bindProp(e,{name:"value",type:"change"})}},initInput=e=>{switch(e.attr("type")){case"file":setKeys(["multiple","files"],e),bindProp(e,{name:"files",type:"change"});break;case"checkbox":setKeys(["checked","multiple"],e),bindProp(e,{name:"checked",type:"change"});break;case"radio":setKeys(["checked"],e),bindProp(e,{name:"checked",type:"change"});break;default:setKeys(["placeholder","value"],e),bindProp(e,{name:"value",type:"input"})}},getFormData=(e,t)=>{const r={};return e.all(t).forEach((e=>{const{name:t,tag:n,ele:a}=e;if("input"===n)switch(e.type){case"checkbox":t in r||(r[t]=[]),a.checked&&r[t].push(a.value);break;case"radio":a.checked&&(r[t]=a.value);break;case"file":r[t]=a.files;break;default:r[t]=a.value}else if("textarea"===n)r[t]=a.value;else if("select"===n){const e=searchEle(a,"option:checked");if(a.multiple)r[t]=e.map((e=>e.value||e.textContent));else{const[n]=e;r[t]=n.value||n.textContent}}else r[t]=e.value})),r};var formFn={formData(e,t={wait:200}){const r=stanz({});return assign(r,getFormData(this,e||"input,select,textarea")),this.watchTick((t=>{assign(r,getFormData(this,e||"input,select,textarea"))}),t.wait),r}};const COMPS={},renderElement=({defaults:e,ele:t,template:r,temps:n})=>{const a={...e.data,...e.attrs},s=eleX(t);e.proto&&s.extend(e.proto,{enumerable:!1});for(let[e,t]of Object.entries(a))s.hasOwnProperty(e)||(s[e]=t);if(e.temp){const e=t.attachShadow({mode:"open"});e.innerHTML=r.innerHTML,render({target:e,data:s,temps:n})}if(e.ready&&e.ready.call(s),e.watch){const t=Object.entries(e.watch);s.watchTick((e=>{for(let[r,n]of t)e.hasModified(r)&&n.call(s,s[r],{watchers:e})}));for(let[e,r]of t)r.call(s,s[e],{})}},register=(e={})=>{const t={tag:"",temp:"",data:{},proto:{},...e};validateTagName(t.tag);const r=capitalizeFirstLetter(hyphenToUpperCase(t.tag));if(COMPS[r])throw`Component ${r} already exists`;const n=document.createElement("template");n.innerHTML=t.temp;const a=convert(n),s=e=>{let t;return t=e instanceof Array?[...e]:Object.keys(e),t},o=COMPS[r]=class extends HTMLElement{constructor(...e){super(...e);const r=eleX(this);if(t.created&&t.created.call(r),t.attrs){const e=s(t.attrs);r.watchTick((t=>{e.forEach((e=>{if(t.hasModified(e)){const t=r[e],n=toDashCase(e);null==t?this.removeAttribute(n):this.setAttribute(n,t)}}))}))}renderElement({defaults:t,ele:this,template:n,temps:a})}connectedCallback(){t.attached&&!isInArray(this)&&t.attached.call(eleX(this))}disconnectedCallback(){t.detached&&!isInArray(this)&&t.detached.call(eleX(this))}attributeChangedCallback(e,t,r){const n=eleX(this);/[^\d.]/.test(r)||"number"!=typeof n[e]||(r=Number(r)),n[hyphenToUpperCase(e)]=r}static get observedAttributes(){return s(t.attrs||{}).map((e=>toDashCase(e)))}};customElements.define(t.tag,o)};function isInArray(e){let t=e;for(;t;){if(t.__inArray)return!0;if(t=t.parentNode||t.host,!t||t.tagName&&"BODY"===t.tagName)break}return!1}function validateTagName(e){if("-"===e.charAt(0)||"-"===e.charAt(e.length-1))throw new Error(`The string "${e}" cannot start or end with "-"`);for(let t=0;t<e.length-1;t++)if("-"===e.charAt(t)&&"-"===e.charAt(t+1))throw new Error(`The string "${e}" cannot have consecutive "-" characters`);if(!e.includes("-"))throw new Error(`The string "${e}" must contain at least one "-"`);return!0}function getConditionEles(e,t=!0){const r=[];let n=t?e.__marked_end:e.__marked_start;for(;;)if(n=t?n.nextSibling:n.previousSibling,n instanceof Comment)n.__$ele&&(r.push(n.__$ele),n=t?n.__end:n.__start);else if(!(n instanceof Text))break;return r}const proto$1={_getRenderData(){let e=this.__marked_end;for(;e&&!e.__render_data;)e=e.parentNode;return e?{target:e,data:e.__render_data,temps:e.__render_temps}:null},_renderMarked(){const{ele:e}=this,{parentNode:t}=e,r=`${this.tag}: ${this.__originHTML.trim().slice(0,20).replace(/\n/g,"")} ...`,n=document.createComment(r+" --start"),a=document.createComment(r+" --end");n.__end=a,a.__start=n,a.__$ele=n.__$ele=this,t.insertBefore(n,e),t.insertBefore(a,e),this.__marked_start=n,this.__marked_end=a,Object.defineProperties(e,{__revokes:{set(e){n.__revokes=e},get:()=>n.__revokes}})},_renderContent(){const e=this._getRenderData();if(!e)return;const{target:t,data:r,temps:n}=e,a=this.__marked_end,s=document.createElement("template");s.innerHTML=this.__originHTML,a.parentNode.insertBefore(s.content,a),render({target:t,data:r,temps:n})},_revokeRender(){const e=this.__marked_start;let t=this.__marked_end.previousSibling;for(;t&&t!==e;){revokeAll(t);const e=t;t=t.previousSibling,e.remove()}},_refreshCondition(){const e=[this];if(!this._refreshing){switch(this.tag){case"x-if":e.push(...getConditionEles(this));break;case"x-else-if":e.unshift(...getConditionEles(this,!1)),e.push(...getConditionEles(this))}e.forEach((e=>e._refreshing=!0)),nextTick((()=>{let t=!1;e.forEach((e=>{if(delete e._refreshing,!t)return e.value||"x-else"===e.tag?(e._renderContent(),void(t=!0)):void e._revokeRender();e._revokeRender()}))}))}}},xifComponentOpts={tag:"x-if",data:{value:null},watch:{value(){this._refreshCondition()}},proto:proto$1,ready(){this.__originHTML=this.html,this.html="",this._renderMarked(),nextTick((()=>this.ele.remove()))}};register(xifComponentOpts),register({...xifComponentOpts,tag:"x-else-if"}),register({tag:"x-else",proto:proto$1,ready:xifComponentOpts.ready});const createItem=(e,t,r,n)=>{const a=new Stanz({$data:e,$host:n}),s=createXEle(t.innerHTML),{ele:o}=s;render({target:o,data:a,temps:r,$host:n,isRenderSelf:!0});const i=o.__revokes,l=()=>{removeArrayValue(i,l),a.revoke()};return i.push(l),{ele:o,itemData:a}},proto={_getRenderData:proto$1._getRenderData,_renderMarked:proto$1._renderMarked,_getChilds(){const e=[],{__marked_end:t,__marked_start:r}=this;if(!r)return[];let n=r;for(;n=n.nextSibling,n&&n!==t;)n instanceof Element&&e.push(n);return e}};register({tag:"x-fill",data:{value:null},watch:{value(e){const t=this._getChilds();if(!e)return void(t&&t.forEach((e=>{revokeAll(e),e.remove()})));if(!(e instanceof Array))return console.warn(`The value of x-fill component must be of type Array, and the type of the current value is ${getType(e)}`),void(t&&t.forEach((e=>{revokeAll(e),e.remove()})));const r=Array.from(e),n=t.map((e=>e.__render_data.$data));if(isArrayEqual(n,r))return;const a=this._name,{data:s,temps:o}=this._getRenderData();if(!o)return;const i=o[hyphenToUpperCase(a)],l=this.__marked_end,c=l.parentNode,h=t.slice(),d=s.$host||s;for(let r=0,a=e.length;r<a;r++){const a=e[r],s=t[r];if(!s){const{ele:e}=createItem(a,i,o,d);c.insertBefore(e,l);continue}const h=s.__render_data.$data;if(a!==h)if(n.includes(a)){const e=t.find((e=>e.__render_data.$data===a));e.__inArray=1,c.insertBefore(e,s),delete e.__inArray,moveArrayValue(t,e,r)}else{const{ele:e}=createItem(a,i,o,d);c.insertBefore(e,s),t.splice(r,0,e)}}h.forEach(((e,t)=>{const a=n[t];r.includes(a)||(revokeAll(e),e.remove())}))}},proto:proto,ready(){this.__originHTML="origin",this._name=this.attr("name"),this._renderMarked(),nextTick((()=>this.ele.remove()))}});const{defineProperties:defineProperties}=Object,init=({_this:e,ele:t,proxySelf:r})=>{const n={owner:{get(){const{parentNode:r}=t,{_owner:n}=e,a=r?[eleX(r),...n]:[...n];return new Set(a)}},ele:{get:()=>t}},a=t.tagName&&t.tagName.toLowerCase();a&&(n.tag={enumerable:!0,value:a}),defineProperties(e,n),initFormEle(r)};class Xhear extends LikeArray{constructor({ele:e}){super();const t=constructor.call(this,{},handler);return init({_this:this,ele:e,proxySelf:t}),e.__xhear__=t,t}get length(){return this.ele.children.length}$(e){const t=this.ele.querySelector(e);return t?eleX(t):null}all(e){return searchEle(this.ele,e).map(eleX)}extend(e,t){return extend(this,e,t)}get text(){return this.ele.textContent}set text(e){this.ele.textContent=e}get html(){return this.ele.innerHTML}set html(e){this.ele.innerHTML=e}get classList(){return this.ele.classList}get data(){return this.ele.dataset}get css(){return getComputedStyle(this.ele)}get shadow(){return eleX(this.ele.shadowRoot)}get root(){const e=this.ele.getRootNode();return e?eleX(e):null}get host(){let e=this.ele.getRootNode(),{host:t}=e;return t?eleX(t):null}get parent(){let{parentNode:e}=this.ele;return e&&e!==document?eleX(e):null}get parents(){const e=[];let t=this;for(;t.parent;)t=t.parent,e.push(t);return e}get next(){const e=this.ele.nextElementSibling;return e?eleX(e):null}get nexts(){const{parent:e}=this,t=this.index;return e.filter(((e,r)=>r>t))}get prev(){const e=this.ele.previousElementSibling;return e?eleX(e):null}get prevs(){const{parent:e}=this,t=this.index;return e.filter(((e,r)=>r<t))}get siblings(){return this.parent.filter((e=>e!==this))}get index(){let{parentNode:e}=this.ele;return e?Array.prototype.indexOf.call(e.children,this.ele):null}get style(){return this.ele.style}set style(e){if("string"==getType(e))return void(this.ele.style=e);let{style:t}=this,r=Array.from(t),n=Object.keys(e);r.forEach((e=>{n.includes(e)||(t[e]="")})),Object.assign(t,e)}get width(){return parseInt(getComputedStyle(this.ele).width)}get height(){return parseInt(getComputedStyle(this.ele).height)}get clientWidth(){return this.ele.clientWidth}get clientHeight(){return this.ele.clientHeight}get offsetWidth(){return this.ele.offsetWidth}get offsetHeight(){return this.ele.offsetHeight}get outerWidth(){let e=getComputedStyle(this.ele);return this.ele.offsetWidth+parseInt(e["margin-left"])+parseInt(e["margin-right"])}get outerHeight(){let e=getComputedStyle(this.ele);return this.ele.offsetHeight+parseInt(e["margin-top"])+parseInt(e["margin-bottom"])}is(e){return meetsEle(this.ele,e)}remove(){this.ele.remove()}}const sfn=Stanz.prototype,fn=Xhear.prototype;fn.extend({get:sfn.get,set:sfn.set,toJSON:sfn.toJSON,toString:sfn.toString,...watchFn,...eventFn,...defaultData,...syncFn,...formFn},{enumerable:!1});const eleX=e=>e?e.__xhear__?e.__xhear__:new Xhear({ele:e}):null,objToXEle=e=>{const t={...e};if(!e.tag)return null;const r=document.createElement(e.tag);delete t.tag;const n=eleX(r);return Object.assign(n,t),n},temp=document.createElement("template"),strToXEle=e=>{temp.innerHTML=e;const t=temp.content.children[0]||temp.content.childNodes[0];return temp.innerHTML="",eleX(t)},createXEle=(e,t)=>{if(e instanceof Xhear)return e;if(e instanceof Element)return eleX(e);switch(getType(e)){case"object":return objToXEle(e);case"string":return strToXEle(e)}},revokeAll=e=>{e.__revokes&&Array.from(e.__revokes).forEach((e=>e&&e())),e.childNodes&&Array.from(e.childNodes).forEach((e=>{revokeAll(e)}))};function $(e){if("string"===getType(e)&&!/<.+>/.test(e)){const t=document.querySelector(e);return eleX(t)}return createXEle(e)}Object.assign($,{stanz:stanz,render:render,convert:convert,register:register,fn:Xhear.prototype,all:e=>searchEle(document,e).map(eleX)});export{$ as default};